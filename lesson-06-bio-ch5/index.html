<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿç‰© Ch5 å”èª¿ä½œç”¨ (Final)</title>
    <style>
        :root { --primary: #2c3e50; --accent: #27ae60; --hormone: #e74c3c; --nerve: #f1c40f; --bg: #f5f7fa; }
        body { font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .brand-watermark { position: fixed; bottom: 20px; right: 20px; background: rgba(26, 42, 108, 0.8); color: white; padding: 8px 15px; border-radius: 50px; font-size: 12px; pointer-events: none; z-index: 1000; }
        
        .nav-container { background: white; width: 100%; padding: 15px 0; box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; justify-content: center; gap: 10px; }
        .nav-btn { padding: 10px 20px; border: none; background: #eee; border-radius: 50px; cursor: pointer; font-weight: bold; color: #555; transition: 0.2s; }
        .nav-btn.active { background: var(--primary); color: white; transform: scale(1.05); }

        .main-container { width: 95%; max-width: 800px; background: white; margin-top: 20px; border-radius: 15px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); min-height: 500px; display: none; animation: fadeIn 0.3s; }
        .main-container.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { margin-top: 0; color: var(--primary); border-bottom: 3px solid #eee; padding-bottom: 10px; }
        .action-btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin: 5px; color: white; font-size: 0.9rem; }
        .btn-green { background: var(--accent); } .btn-red { background: var(--hormone); } .btn-blue { background: #3498db; } .btn-gray { background: #95a5a6; }

        /* --- Scene 1: ç¥ç¶“ --- */
        .pathway-box { display: flex; justify-content: center; gap: 5px; margin: 40px 0; flex-wrap: wrap; }
        .node { width: 70px; height: 70px; border: 3px solid var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; background: white; transition: 0.2s; box-shadow: 0 4px 0 rgba(0,0,0,0.1); }
        .node.active { background: #fffbe6; border-color: var(--nerve); transform: scale(1.15); box-shadow: 0 0 15px var(--nerve); }
        .log-box { background: #f9f9f9; padding: 15px; border-radius: 8px; text-align: center; color: #555; border-left: 5px solid var(--primary); margin-top: 20px; }

        /* --- Scene 2: å…§åˆ†æ³Œ --- */
        .hormone-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .hormone-card { background: #fffcfc; border: 1px solid #eee; border-radius: 10px; padding: 15px; position: relative; }
        .sugar-stage { height: 140px; border-left: 2px solid #333; border-bottom: 2px solid #333; position: relative; margin: 10px; }
        .limit-line { position: absolute; width: 100%; border-top: 1px dashed #ccc; font-size: 10px; color: #aaa; }
        .ball { width: 20px; height: 20px; background: var(--hormone); border-radius: 50%; position: absolute; left: 50%; bottom: 50%; transform: translateX(-50%); transition: bottom 0.8s; }
        .patient-face { font-size: 4rem; text-align: center; margin: 10px 0; }
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake { 0% { transform: rotate(0deg); } 25% { transform: rotate(5deg); } 75% { transform: rotate(-5deg); } }

        /* --- Scene 3: æ¤ç‰© (è¦–è¦ºä½ç½®ä¿®æ­£) --- */
        .plant-stage { 
            position: relative; width: 100%; height: 280px; 
            background: #fffcf5; border: 2px solid #e0e0e0; border-radius: 12px; 
            overflow: hidden; margin-top: 20px;
        }

        /* å€’æ”¾çµ„ä»¶ï¼šä½ç½®ä¸Šç§»è‡³ top: 30% (åŸç‚º 50%) */
        .geo-group { position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); width: 220px; height: 40px; display: none; }
        .seed { width: 30px; height: 30px; background: #5d4037; border-radius: 50%; position: absolute; left: 95px; top: 5px; z-index: 5; }
        
        /* è– (å³) */
        .stem { 
            position: absolute; left: 110px; top: 10px; 
            width: 100px; height: 18px; 
            background: #27ae60; 
            border-radius: 0 10px 10px 0; 
            transform-origin: left center; 
            transition: transform 2s ease-in-out, border-radius 2s;
        }
        
        /* æ ¹ (å·¦) */
        .root { 
            position: absolute; right: 110px; top: 12px; 
            width: 100px; height: 12px; 
            background: #a1887f; 
            border-radius: 10px 0 0 10px; 
            transform-origin: right center; 
            transition: transform 2s ease-in-out, border-radius 2s;
        }

        /* å«ç¾è‰ */
        .mimosa-group { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); display: none; }
        .mimosa-stick { width: 4px; height: 120px; background: #388e3c; margin: 0 auto; }
        .leaf-pair { position: absolute; top: 10px; left: -50px; cursor: pointer; }
        .leaf { width: 50px; height: 20px; background: #4caf50; border-radius: 20px 0; display: inline-block; transition: 0.2s; transform-origin: right center; }
        .leaf.r { border-radius: 0 20px; transform-origin: left center; margin-left: -4px; }
    </style>
</head>
<body>

    <div class="nav-container">
        <button class="nav-btn active" onclick="showScene('neuro')">ğŸ§  ç¥ç¶“å‚³å°</button>
        <button class="nav-btn" onclick="showScene('hormone')">ğŸ’‰ å…§åˆ†æ³Œ</button>
        <button class="nav-btn" onclick="showScene('plant')">ğŸŒ¿ æ¤ç‰©æ„Ÿæ‡‰</button>
    </div>

    <div id="neuro" class="main-container active">
        <h2>åˆºæ¿€èˆ‡åæ‡‰</h2>
        <div class="pathway-box">
            <div class="node" id="n1">å—å™¨</div> <div class="arrow">âœ</div>
            <div class="node" id="n2">æ„Ÿç¥</div> <div class="arrow">âœ</div>
            <div class="node" id="n3" style="border-color:#e74c3c">ä¸­æ¨</div> <div class="arrow">âœ</div>
            <div class="node" id="n4">é‹ç¥</div> <div class="arrow">âœ</div>
            <div class="node" id="n5">å‹•å™¨</div>
        </div>
        <div style="text-align:center;">
            <button class="action-btn btn-red" onclick="runPath('reflex')">ğŸ”¥ æ‘¸ç†±é‹ (åå°„)</button>
            <button class="action-btn btn-blue" onclick="runPath('conscious')">ğŸ¦Ÿ æ‰“èšŠå­ (æ„è­˜)</button>
        </div>
        <div id="neuro-log" class="log-box">è«‹é¸æ“‡åˆºæ¿€...</div>
    </div>

    <div id="hormone" class="main-container">
        <h2>å…§åˆ†æ³Œç³»çµ±</h2>
        <div class="hormone-grid">
            <div class="hormone-card">
                <div style="text-align:center; font-weight:bold; margin-bottom:5px;">è¡€ç³–æ†å®š</div>
                <div class="sugar-stage">
                    <div class="limit-line" style="top:20%">High</div>
                    <div class="limit-line" style="bottom:20%">Low</div>
                    <div class="ball" id="ball"></div>
                </div>
                <div style="text-align:center;">
                    <button class="action-btn btn-red" onclick="sugarEffect(85)">ğŸ± åƒé£½</button>
                    <button class="action-btn btn-blue" onclick="sugarEffect(15)">ğŸƒ é‹å‹•</button>
                </div>
            </div>
            <div class="hormone-card">
                <div style="text-align:center; font-weight:bold;">æ¿€ç´ è¨ºæ‰€</div>
                <div class="patient-face" id="face">ğŸ˜</div>
                <div style="text-align:center;">
                    <select id="h-select"><option value="gh">ç”Ÿé•·æ¿€ç´ </option><option value="th">ç”²ç‹€è…ºç´ </option></select>
                    <div>
                        <button class="action-btn btn-gray" onclick="docCheck('low')">â¬‡ï¸ ä¸è¶³</button>
                        <button class="action-btn btn-gray" onclick="docCheck('high')">â¬†ï¸ éé‡</button>
                    </div>
                    <div id="doc-log" style="color:#c0392b; font-weight:bold; margin-top:5px;"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="plant" class="main-container">
        <h2>æ¤ç‰©æ„Ÿæ‡‰</h2>
        <div class="plant-stage">
            <div id="geo-group" class="geo-group">
                <div class="seed"></div>
                <div id="stem" class="stem"></div>
                <div id="root" class="root"></div>
            </div>
            <div id="mimosa-group" class="mimosa-group">
                <div class="mimosa-stick"></div>
                <div class="leaf-pair" onclick="mimosaTouch()">
                    <div id="leaf-l" class="leaf"></div>
                    <div id="leaf-r" class="leaf r"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; margin-top:15px;">
            <button class="action-btn btn-green" onclick="plantMode('geo')">ğŸŒ å‘åœ°æ€§</button>
            <button class="action-btn btn-green" onclick="plantMode('touch')">ğŸ–ï¸ å«ç¾è‰</button>
            <button class="action-btn btn-gray" onclick="resetPlant()">ğŸ”„ é‡ç½®</button>
        </div>
        <div id="plant-msg" class="log-box" style="text-align:left;">è«‹é¸æ“‡å¯¦é©—...</div>
    </div>

    <div class="brand-watermark">STEM INSIGHT</div>

    <script>
        function showScene(id) {
            document.querySelectorAll('.main-container').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
        }
        // ç¥ç¶“
        async function runPath(type) {
            const nodes = ['n1','n2','n3','n4','n5']; const speed = type==='reflex'?100:400;
            document.getElementById('neuro-log').innerText = type==='reflex' ? "åå°„ï¼šå¿«ï¼ä¸ç¶“å¤§è…¦ï¼" : "æ„è­˜ï¼šæ…¢ï¼è¦ç¶“éå¤§è…¦ï¼";
            nodes.forEach(id=>document.getElementById(id).classList.remove('active'));
            for(let id of nodes) {
                document.getElementById(id).classList.add('active');
                await new Promise(r=>setTimeout(r,speed));
                document.getElementById(id).classList.remove('active');
            }
            document.getElementById('n5').classList.add('active'); setTimeout(()=>document.getElementById('n5').classList.remove('active'),1000);
        }
        // å…§åˆ†æ³Œ
        function sugarEffect(val) {
            const ball = document.getElementById('ball'); ball.style.bottom = val + "%";
            setTimeout(()=>{ ball.style.bottom = "50%"; }, 2000);
        }
        function docCheck(lvl) {
            const type=document.getElementById('h-select').value; const f=document.getElementById('face'); const l=document.getElementById('doc-log');
            f.innerText="ğŸ˜"; f.style.transform="scale(1)"; f.classList.remove('shake');
            setTimeout(()=>{
                if(type==='gh') {
                    if(lvl==='high') { f.innerText="ğŸ˜²"; f.style.transform="scale(1.3)"; l.innerText="å·¨äººç—‡"; }
                    else { f.innerText="ğŸ‘¶"; f.style.transform="scale(0.7)"; l.innerText="ä¾å„’ç—‡"; }
                } else {
                    if(lvl==='high') { f.innerText="ğŸ‘€"; f.classList.add('shake'); l.innerText="äº¢é€²"; }
                    else { f.innerText="ğŸ˜´"; f.style.transform="scale(1.1)"; l.innerText="å‘†å°ç—‡"; }
                }
            },50);
        }
        // æ¤ç‰©
        function plantMode(mode) {
            resetPlant();
            if(mode==='geo') {
                document.getElementById('geo-group').style.display='block';
                document.getElementById('plant-msg').innerText = "æ¤ç‰©å€’æ”¾ä¸­...";
                setTimeout(()=>{
                    // è–ï¼šå‘ä¸Š (-50deg)
                    const s = document.getElementById('stem'); s.style.transform="rotate(-50deg)"; s.style.borderRadius="0 0 50px 0";
                    // æ ¹ï¼šå‘ä¸‹ (-50deg, å› ç‚ºåˆå§‹åœ¨å·¦é‚Š)
                    const r = document.getElementById('root'); r.style.transform="rotate(-50deg)"; r.style.borderRadius="0 0 0 50px";
                    document.getElementById('plant-msg').innerText = "çµæœï¼šè–èƒŒåœ°(ä¸Šå½)ï¼Œæ ¹å‘åœ°(ä¸‹å½)ã€‚";
                },1000);
            } else {
                document.getElementById('mimosa-group').style.display='block';
                document.getElementById('plant-msg').innerText = "é»æ“Šè‘‰å­...";
            }
        }
        function mimosaTouch() {
            document.getElementById('leaf-l').style.transform="rotate(30deg) scaleX(0.5)";
            document.getElementById('leaf-r').style.transform="rotate(-30deg) scaleX(0.5)";
            document.getElementById('plant-msg').innerText = "é–‰åˆï¼(è†¨å£“æ”¹è®Š)";
        }
        function resetPlant() {
            document.getElementById('geo-group').style.display='none'; document.getElementById('mimosa-group').style.display='none';
            const s=document.getElementById('stem'); const r=document.getElementById('root');
            s.style.transform="rotate(0deg)"; s.style.borderRadius="0 10px 10px 0";
            r.style.transform="rotate(0deg)"; r.style.borderRadius="10px 0 0 10px";
            document.getElementById('leaf-l').style.transform="none"; document.getElementById('leaf-r').style.transform="none";
            document.getElementById('plant-msg').innerText="";
        }
    </script>
</body>
</html>