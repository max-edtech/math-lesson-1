<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿç‰© Ch5 å”èª¿ä½œç”¨ (Stable)</title>
    <style>
        :root { --primary: #2c3e50; --accent: #27ae60; --hormone: #e74c3c; --nerve: #f1c40f; --bg: #f5f7fa; }
        body { font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        .brand-watermark { position: fixed; bottom: 20px; right: 20px; background: rgba(26, 42, 108, 0.8); color: white; padding: 8px 15px; border-radius: 50px; font-size: 12px; pointer-events: none; z-index: 1000; }
        
        /* å°èˆªå€ */
        .nav-container { background: white; width: 100%; padding: 15px 0; box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; justify-content: center; gap: 10px; position: sticky; top: 0; z-index: 100; }
        .nav-btn { padding: 10px 20px; border: none; background: #eee; border-radius: 50px; cursor: pointer; font-weight: bold; color: #555; transition: 0.2s; font-size: 0.95rem; }
        .nav-btn.active { background: var(--primary); color: white; transform: scale(1.05); }
        .nav-btn:hover:not(.active) { background: #e0e0e0; }

        /* ä¸»å…§å®¹å€ (é™åˆ¶å¯¬åº¦ï¼Œé˜²æ­¢è·‘ç‰ˆ) */
        .main-container { width: 95%; max-width: 800px; background: white; margin-top: 20px; border-radius: 15px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); min-height: 500px; display: none; animation: fadeIn 0.3s; }
        .main-container.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { margin-top: 0; color: var(--primary); border-bottom: 3px solid #eee; padding-bottom: 10px; }
        .subtitle { color: #7f8c8d; font-size: 0.9rem; margin-bottom: 20px; display: block; }

        /* é€šç”¨æŒ‰éˆ• */
        .action-btn { padding: 10px 18px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin: 5px; color: white; transition: 0.2s; font-size: 0.9rem; display: inline-flex; align-items: center; gap: 5px; }
        .action-btn:active { transform: scale(0.95); }
        .btn-green { background: var(--accent); }
        .btn-red { background: var(--hormone); }
        .btn-blue { background: #3498db; }
        .btn-gray { background: #95a5a6; }

        /* --- Scene 1: ç¥ç¶“ç³»çµ± --- */
        .pathway-box { display: flex; align-items: center; justify-content: center; gap: 5px; margin: 40px 0; flex-wrap: wrap; }
        .node { width: 70px; height: 70px; border: 3px solid var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 13px; background: white; transition: 0.2s; position: relative; z-index: 2; box-shadow: 0 5px 0 rgba(0,0,0,0.1); }
        .arrow { font-size: 1.5rem; color: #ccc; }
        .node.active { background: #fffbe6; border-color: var(--nerve); transform: scale(1.15); box-shadow: 0 0 15px var(--nerve); z-index: 3; }
        .log-box { background: #f9f9f9; padding: 15px; border-radius: 8px; text-align: center; color: #555; font-weight: bold; min-height: 24px; border-left: 5px solid var(--primary); }

        /* --- Scene 2: å…§åˆ†æ³Œ (é›™å€å¡Š) --- */
        .hormone-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        @media (max-width: 600px) { .hormone-grid { grid-template-columns: 1fr; } }
        
        .hormone-card { background: #fffcfc; border: 1px solid #eee; border-radius: 10px; padding: 15px; position: relative; }
        .tag { position: absolute; top: 10px; right: 10px; background: #eee; padding: 2px 8px; font-size: 10px; border-radius: 4px; color: #777; }

        /* è¡€ç³–çƒ */
        .sugar-stage { height: 150px; border-left: 2px solid #333; border-bottom: 2px solid #333; position: relative; margin: 20px 10px; background: white; }
        .limit-line { position: absolute; width: 100%; border-top: 1px dashed #ccc; font-size: 10px; color: #aaa; }
        .ball { width: 20px; height: 20px; background: var(--hormone); border-radius: 50%; position: absolute; left: 50%; bottom: 50%; transform: translateX(-50%); transition: bottom 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); }

        /* è¨ºæ‰€ç—…äºº */
        .patient-face { font-size: 4rem; text-align: center; margin: 10px 0; transition: 0.3s; }
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake { 0% { transform: rotate(0deg); } 25% { transform: rotate(5deg); } 75% { transform: rotate(-5deg); } 100% { transform: rotate(0deg); } }

        /* --- Scene 3: æ¤ç‰©æ„Ÿæ‡‰ (ä¿®å¾©ç‰ˆ) --- */
        .plant-stage { 
            position: relative; width: 100%; height: 280px; 
            background: #fffcf5; border: 2px solid #e0e0e0; border-radius: 12px; 
            overflow: hidden; margin-top: 20px;
        }

        /* æ°´å¹³å¯¦é©—çµ„ */
        .geo-group { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 220px; height: 40px; display: none; }
        .seed { width: 30px; height: 30px; background: #5d4037; border-radius: 50%; position: absolute; left: 95px; top: 5px; z-index: 5; }
        
        /* è– (å³é‚Š) */
        .stem { 
            position: absolute; left: 110px; top: 10px; 
            width: 100px; height: 18px; 
            background: #27ae60; 
            border-radius: 0 10px 10px 0; 
            transform-origin: left center; /* ä»¥ç¨®å­ç‚ºè»¸å¿ƒ */
            transition: transform 2s ease-in-out, border-radius 2s;
        }
        
        /* æ ¹ (å·¦é‚Š) */
        .root { 
            position: absolute; right: 110px; top: 12px; 
            width: 100px; height: 12px; 
            background: #a1887f; 
            border-radius: 10px 0 0 10px; 
            transform-origin: right center; /* ä»¥ç¨®å­ç‚ºè»¸å¿ƒ */
            transition: transform 2s ease-in-out, border-radius 2s;
        }

        /* å«ç¾è‰ */
        .mimosa-group { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); display: none; }
        .mimosa-stick { width: 4px; height: 120px; background: #388e3c; margin: 0 auto; }
        .leaf-pair { position: absolute; top: 10px; left: -50px; cursor: pointer; }
        .leaf { width: 50px; height: 20px; background: #4caf50; border-radius: 20px 0; display: inline-block; transition: 0.2s; transform-origin: right center; }
        .leaf.r { border-radius: 0 20px; transform-origin: left center; margin-left: -4px; }
    </style>
</head>
<body>

    <div class="nav-container">
        <button class="nav-btn active" onclick="showScene('neuro')">ğŸ§  ç¥ç¶“å‚³å°</button>
        <button class="nav-btn" onclick="showScene('hormone')">ğŸ’‰ å…§åˆ†æ³Œ</button>
        <button class="nav-btn" onclick="showScene('plant')">ğŸŒ¿ æ¤ç‰©æ„Ÿæ‡‰</button>
    </div>

    <div id="neuro" class="main-container active">
        <h2>åˆºæ¿€èˆ‡åæ‡‰ï¼šèª°å¿«èª°æ…¢ï¼Ÿ</h2>
        <span class="subtitle">è§€å¯Ÿè¨Šè™Ÿå‚³éçš„è·¯å¾‘å·®ç•°ã€‚</span>

        <div class="pathway-box">
            <div class="node" id="n1">å—å™¨</div> <div class="arrow">âœ</div>
            <div class="node" id="n2">æ„Ÿè¦º<br>ç¥ç¶“</div> <div class="arrow">âœ</div>
            <div class="node" id="n3" style="border-color:#e74c3c">ä¸­æ¨<br>(è…¦/è„Š)</div> <div class="arrow">âœ</div>
            <div class="node" id="n4">é‹å‹•<br>ç¥ç¶“</div> <div class="arrow">âœ</div>
            <div class="node" id="n5">å‹•å™¨</div>
        </div>

        <div style="text-align:center;">
            <button class="action-btn btn-red" onclick="runPath('reflex')">ğŸ”¥ æ‘¸ç†±é‹ (åå°„)</button>
            <button class="action-btn btn-blue" onclick="runPath('conscious')">ğŸ¦Ÿ æ‰“èšŠå­ (æ„è­˜)</button>
        </div>
        <div id="neuro-log" class="log-box" style="margin-top:20px;">è«‹é¸æ“‡åˆºæ¿€...</div>
    </div>

    <div id="hormone" class="main-container">
        <h2>å…§åˆ†æ³Œç³»çµ±ï¼šåŒ–å­¸å‚³è¨Šå…µ</h2>
        <div class="hormone-grid">
            <div class="hormone-card">
                <div class="tag">è¡€ç³–æ†å®š</div>
                <div class="sugar-stage">
                    <div class="limit-line" style="top:20%">é«˜è¡€ç³– (High)</div>
                    <div class="limit-line" style="bottom:20%">ä½è¡€ç³– (Low)</div>
                    <div class="ball" id="ball"></div>
                </div>
                <div style="text-align:center; margin-top:10px;">
                    <div id="sugar-msg" style="font-weight:bold; height:20px; color:#27ae60;">æ­£å¸¸</div>
                    <button class="action-btn btn-red" onclick="sugarEffect(85)">ğŸ± åƒé£½</button>
                    <button class="action-btn btn-blue" onclick="sugarEffect(15)">ğŸƒ é‹å‹•</button>
                </div>
            </div>

            <div class="hormone-card">
                <div class="tag">æ¿€ç´ è¨ºæ‰€</div>
                <div class="patient-face" id="face">ğŸ˜</div>
                <div style="text-align:center;">
                    <select id="h-select" style="padding:5px; border-radius:5px;">
                        <option value="gh">ç”Ÿé•·æ¿€ç´  (è…¦å‚è…º)</option>
                        <option value="th">ç”²ç‹€è…ºç´  (ç”²ç‹€è…º)</option>
                    </select>
                    <div style="margin-top:10px;">
                        <button class="action-btn btn-gray" onclick="docCheck('low')">â¬‡ï¸ ä¸è¶³</button>
                        <button class="action-btn btn-gray" onclick="docCheck('high')">â¬†ï¸ éé‡</button>
                    </div>
                    <div id="doc-log" style="font-weight:bold; color:#c0392b; margin-top:10px; font-size:0.9rem;"></div>
                    <button class="action-btn" onclick="resetDoc()" style="margin-top:5px; font-size:0.8rem;">å¾©åŸ</button>
                </div>
            </div>
        </div>
    </div>

    <div id="plant" class="main-container">
        <h2>æ¤ç‰©æ„Ÿæ‡‰ï¼šç”Ÿé•·ç´  vs è†¨å£“</h2>
        <span class="subtitle">æ³¨æ„è§€å¯Ÿå€’ä¸‹å¾Œï¼Œæ ¹èˆ‡è–çš„å½æ›²æ–¹å‘ã€‚</span>

        <div class="plant-stage">
            <div id="geo-group" class="geo-group">
                <div class="seed"></div>
                <div id="stem" class="stem"><span style="position:absolute; right:-25px; color:#27ae60; font-size:12px;">è–</span></div>
                <div id="root" class="root"><span style="position:absolute; left:-25px; color:#a1887f; font-size:12px;">æ ¹</span></div>
            </div>
            
            <div id="mimosa-group" class="mimosa-group">
                <div class="mimosa-stick"></div>
                <div class="leaf-pair" onclick="mimosaTouch()">
                    <div id="leaf-l" class="leaf"></div>
                    <div id="leaf-r" class="leaf r"></div>
                </div>
                <div style="position:absolute; bottom:10px; font-size:12px; color:#666; width:100px; text-align:center; left:-50px;">é»æ“Šè‘‰å­</div>
            </div>
        </div>

        <div style="text-align:center; margin-top:20px;">
            <button class="action-btn btn-green" onclick="plantMode('geo')">ğŸŒ å‘åœ°æ€§å¯¦é©—</button>
            <button class="action-btn btn-green" onclick="plantMode('touch')">ğŸ–ï¸ å«ç¾è‰å¯¦é©—</button>
            <button class="action-btn btn-gray" onclick="resetPlant()">ğŸ”„ é‡ç½®</button>
        </div>
        <div id="plant-msg" class="log-box" style="margin-top:15px; text-align:left;">è«‹é¸æ“‡å¯¦é©—...</div>
    </div>

    <div class="brand-watermark">STEM INSIGHT</div>

    <script>
        function showScene(id) {
            document.querySelectorAll('.main-container').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
        }

        // --- ç¥ç¶“é‚è¼¯ ---
        async function runPath(type) {
            const nodes = ['n1', 'n2', 'n3', 'n4', 'n5'];
            const speed = type === 'reflex' ? 100 : 400;
            const log = document.getElementById('neuro-log');
            log.innerText = type === 'reflex' ? "è„Šé«“åå°„ï¼šä¸ç¶“å¤§è…¦ï¼Œé€Ÿåº¦æ¥µå¿«ï¼" : "å¤§è…¦æ„è­˜ï¼šéœ€è¦åˆ¤æ–·ï¼Œé€Ÿåº¦è¼ƒæ…¢ã€‚";
            log.style.borderColor = type === 'reflex' ? "#e74c3c" : "#3498db";

            nodes.forEach(id => document.getElementById(id).classList.remove('active'));

            for(let id of nodes) {
                document.getElementById(id).classList.add('active');
                await new Promise(r => setTimeout(r, speed));
                document.getElementById(id).classList.remove('active');
            }
            document.getElementById('n5').classList.add('active'); // çµ‚é»äº®èµ·
            setTimeout(() => document.getElementById('n5').classList.remove('active'), 1000);
        }

        // --- å…§åˆ†æ³Œé‚è¼¯ ---
        function sugarEffect(val) {
            const ball = document.getElementById('ball');
            const msg = document.getElementById('sugar-msg');
            ball.style.bottom = val + "%";
            
            if(val > 80) {
                msg.innerText = "éé«˜ (èƒ°å³¶ç´ ä½œç”¨ä¸­...)";
                msg.style.color = "#e74c3c";
                setTimeout(() => { ball.style.bottom = "50%"; msg.innerText = "æ¢å¾©æ†å®š"; msg.style.color = "#27ae60"; }, 2000);
            } else if (val < 20) {
                msg.innerText = "éä½ (å‡ç³–ç´ ä½œç”¨ä¸­...)";
                msg.style.color = "#3498db";
                setTimeout(() => { ball.style.bottom = "50%"; msg.innerText = "æ¢å¾©æ†å®š"; msg.style.color = "#27ae60"; }, 2000);
            }
        }

        function docCheck(lvl) {
            const type = document.getElementById('h-select').value;
            const face = document.getElementById('face');
            const log = document.getElementById('doc-log');
            
            resetDoc();
            setTimeout(() => {
                if(type === 'gh') {
                    if(lvl === 'high') { face.innerText = "ğŸ˜²"; face.style.transform = "scale(1.3)"; log.innerText = "å¹¼å¹´éå¤šï¼šå·¨äººç—‡"; }
                    else { face.innerText = "ğŸ‘¶"; face.style.transform = "scale(0.7)"; log.innerText = "å¹¼å¹´ä¸è¶³ï¼šä¾å„’ç—‡"; }
                } else {
                    if(lvl === 'high') { face.innerText = "ğŸ‘€"; face.classList.add('shake'); log.innerText = "äº¢é€²ï¼šçœ¼çªã€å¿ƒæ‚¸ã€æ¶ˆç˜¦"; }
                    else { face.innerText = "ğŸ˜´"; face.style.transform = "scale(1.1)"; log.innerText = "ä¸è¶³ï¼šå‘†å°ç—‡ (æ™ºåŠ›å—æ)"; }
                }
            }, 50);
        }
        function resetDoc() {
            const f = document.getElementById('face');
            f.innerText = "ğŸ˜"; f.style.transform = "scale(1)"; f.classList.remove('shake');
            document.getElementById('doc-log').innerText = "";
        }

        // --- æ¤ç‰©é‚è¼¯ (Physics Fix) ---
        function plantMode(mode) {
            resetPlant();
            if(mode === 'geo') {
                document.getElementById('geo-group').style.display = 'block';
                document.getElementById('plant-msg').innerHTML = "æ¤ç‰©æ°´å¹³æ”¾ç½®...ç”Ÿé•·ç´ æ²‰é™ä¸­...<br>(ç”Ÿé•·ç´ åœ¨æ ¹èˆ‡è–çš„ä½œç”¨ç›¸å)";
                
                setTimeout(() => {
                    // è–ï¼šå‘ä¸Šå½ (rotate -50deg)
                    const s = document.getElementById('stem');
                    s.style.transform = "rotate(-50deg)";
                    s.style.borderRadius = "0 0 50px 0"; // ä¸‹å´ä¼¸é•·
                    
                    // æ ¹ï¼šå‘ä¸‹å½ (rotate -50deg) 
                    // è¨»ï¼šæ ¹åŸæœ¬åœ¨å·¦é‚Šï¼Œtransform-originæ˜¯å³é‚Š(ç¨®å­)ï¼Œé€†æ™‚é‡è½‰(-50deg)å°±æ˜¯é ­å¾€ä¸‹æ‰
                    const r = document.getElementById('root');
                    r.style.transform = "rotate(-50deg)";
                    r.style.borderRadius = "0 0 0 50px"; // ä¸Šå´ä¼¸é•·(ä¸‹å´è¢«æŠ‘åˆ¶)

                    document.getElementById('plant-msg').innerHTML = "<b>çµæœï¼š</b><br>1. è–(èƒŒåœ°)ï¼šä¸‹å´é•·å¾—å¿« â®• å‘ä¸Šå½ã€‚<br>2. æ ¹(å‘åœ°)ï¼šä¸‹å´è¢«æŠ‘åˆ¶ â®• å‘ä¸‹å½ã€‚<br>(æ³¨æ„çœ‹ï¼Œæ ¹ç¢ºå¯¦æ˜¯å¾€ä¸‹é•·çš„ï¼)";
                }, 1000);

            } else {
                document.getElementById('mimosa-group').style.display = 'block';
                document.getElementById('plant-msg').innerText = "é»æ“Šè‘‰å­è§€å¯Ÿè†¨å£“è®ŠåŒ–ã€‚";
            }
        }

        function mimosaTouch() {
            document.getElementById('leaf-l').style.transform = "rotate(30deg) scaleX(0.5)";
            document.getElementById('leaf-r').style.transform = "rotate(-30deg) scaleX(0.5)";
            document.getElementById('plant-msg').innerHTML = "<b>é–‰åˆï¼</b><br>æ°´åˆ†æµå¤±é€ æˆï¼Œé€Ÿåº¦å¿«ï¼Œèˆ‡ç”Ÿé•·ç„¡é—œã€‚";
        }

        function resetPlant() {
            document.getElementById('geo-group').style.display = 'none';
            document.getElementById('mimosa-group').style.display = 'none';
            
            const s = document.getElementById('stem');
            const r = document.getElementById('root');
            s.style.transform = "rotate(0deg)"; s.style.borderRadius = "0 10px 10px 0";
            r.style.transform = "rotate(0deg)"; r.style.borderRadius = "10px 0 0 10px";

            document.getElementById('leaf-l').style.transform = "rotate(0deg)";
            document.getElementById('leaf-r').style.transform = "rotate(0deg)";
            document.getElementById('plant-msg').innerText = "";
        }
    </script>
</body>
</html>