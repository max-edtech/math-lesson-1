<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿç‰© Ch5 è‡ªå‹•åŒ–è¨ºæ–·ç³»çµ± (Auto-Tutor Bio)</title>
    <style>
        :root { --primary: #2c3e50; --accent: #27ae60; --hormone: #e74c3c; --nerve: #f1c40f; --bg: #f5f7fa; --purple: #9b59b6; }
        body { font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        .brand-watermark { position: fixed; bottom: 20px; right: 20px; background: rgba(26, 42, 108, 0.8); color: white; padding: 8px 15px; border-radius: 50px; font-size: 12px; pointer-events: none; z-index: 1000; }
        
        /* é ‚éƒ¨å°èˆª */
        .top-bar { width: 100%; background: white; padding: 10px 0; display: flex; justify-content: center; gap: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .nav-btn { padding: 8px 20px; border: none; background: #eee; border-radius: 50px; cursor: pointer; font-weight: bold; color: #555; transition: 0.2s; }
        .nav-btn.active { background: var(--primary); color: white; transform: scale(1.05); }
        .print-btn { background: var(--purple); color: white; display: flex; align-items: center; gap: 5px; }

        /* ä¸»å®¹å™¨ */
        .main-container { width: 95%; max-width: 800px; background: white; margin-top: 20px; border-radius: 15px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); min-height: 550px; display: none; position: relative; padding-bottom: 80px; }
        .main-container.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { margin-top: 0; color: var(--primary); border-bottom: 3px solid #eee; padding-bottom: 10px; display: flex; justify-content: space-between; }
        .status-badge { font-size: 0.9rem; background: #eee; padding: 5px 12px; border-radius: 15px; color: #555; }

        /* é€šç”¨æŒ‰éˆ• */
        .action-btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin: 5px; color: white; font-size: 1rem; transition: 0.2s; box-shadow: 0 4px 0 rgba(0,0,0,0.1); }
        .action-btn:active { transform: translateY(4px); box-shadow: none; }
        .btn-green { background: var(--accent); } .btn-red { background: var(--hormone); } .btn-blue { background: #3498db; } .btn-dark { background: var(--primary); }

        /* --- é–‰é–æ¨¡å¼ Next æŒ‰éˆ• --- */
        .next-btn { 
            position: absolute; bottom: 20px; right: 20px; 
            background: var(--purple); color: white; 
            padding: 12px 30px; border-radius: 50px; 
            font-size: 1.1rem; font-weight: bold; border: none; 
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4); cursor: pointer;
            display: none; /* é è¨­éš±è— */
            animation: bounceIn 0.5s;
        }
        .next-btn:hover { background: #8e44ad; transform: scale(1.05); }
        @keyframes bounceIn { 0% { opacity: 0; transform: scale(0.3); } 50% { transform: scale(1.05); } 100% { opacity: 1; transform: scale(1); } }

        /* --- é¡Œç›®é¡¯ç¤ºå€ --- */
        .question-box { background: #fdfdfd; border: 2px dashed #ccc; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center; font-size: 1.2rem; font-weight: bold; color: #333; }
        .feedback-area { min-height: 40px; text-align: center; font-weight: bold; margin-top: 10px; font-size: 1.1rem; }

        /* --- Scene 1: ç¥ç¶“ (è·¯å¾‘æ’åº) --- */
        .pathway-container { display: flex; justify-content: center; gap: 10px; margin: 30px 0; flex-wrap: wrap; align-items: center; }
        .node { width: 80px; height: 80px; border: 3px solid #ddd; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; background: white; color: #aaa; transition: 0.3s; position: relative; }
        .node.active { background: #fffbe6; border-color: var(--nerve); color: #333; transform: scale(1.1); box-shadow: 0 0 15px var(--nerve); }
        .node-label { font-size: 0.9rem; }
        .arrow { font-size: 1.5rem; color: #ddd; }
        .arrow.active { color: var(--primary); }

        /* --- Scene 2: å…§åˆ†æ³Œ (ç—…æ­·è¡¨) --- */
        .chart-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .patient-card { background: white; border: 2px solid #333; border-radius: 10px; padding: 20px; text-align: center; box-shadow: 5px 5px 0 rgba(0,0,0,0.1); }
        .patient-face { font-size: 5rem; margin: 10px 0; transition: 0.3s; }
        .symptom-list { text-align: left; background: #f9f9f9; padding: 10px; border-radius: 5px; font-size: 0.95rem; line-height: 1.6; color: #555; }
        .diagnosis-panel { display: flex; flex-direction: column; gap: 10px; justify-content: center; }

        /* --- Scene 3: æ¤ç‰© (å¯¦é©—é æ¸¬) --- */
        .plant-stage { position: relative; width: 100%; height: 250px; background: #fffcf5; border: 2px solid #e0e0e0; border-radius: 12px; overflow: hidden; margin-bottom: 20px; }
        .seed-group { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 200px; height: 40px; }
        .seed { width: 30px; height: 30px; background: #5d4037; border-radius: 50%; position: absolute; left: 85px; top: 5px; z-index: 5; }
        .stem { position: absolute; left: 100px; top: 10px; width: 80px; height: 15px; background: #27ae60; border-radius: 0 10px 10px 0; transform-origin: left center; transition: 1s; }
        .root { position: absolute; right: 100px; top: 12px; width: 80px; height: 10px; background: #a1887f; border-radius: 10px 0 0 10px; transform-origin: right center; transition: 1s; }

        /* --- åˆ—å°æ¨¡å¼ (CSS Print) --- */
        @media print {
            .top-bar, .next-btn, .action-btn, .brand-watermark { display: none !important; }
            body { background: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .main-container { display: block !important; box-shadow: none; border: 1px solid #ccc; page-break-inside: avoid; margin: 0 auto 30px auto; width: 100%; max-width: 100%; min-height: auto; padding-bottom: 20px; }
            .main-container:not(.active) { opacity: 0.5; filter: grayscale(100%); border-style: dashed; }
            .question-box { border: 2px solid black; background: white; color: black; }
            .feedback-area::after { content: " (å­¸ç”Ÿç°½åï¼š______________)"; display: block; margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px; color: #333; font-weight: normal; font-size: 0.9rem; text-align: right; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <button class="nav-btn active" onclick="switchScene('neuro')">ğŸ§  ç¥ç¶“åˆ¤æ–·</button>
        <button class="nav-btn" onclick="switchScene('hormone')">ğŸ‘¨â€âš•ï¸ å…§åˆ†æ³Œé–€è¨º</button>
        <button class="nav-btn" onclick="switchScene('plant')">ğŸŒ± æ¤ç‰©å¯¦é©—</button>
        <button class="nav-btn print-btn" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°ç´€éŒ„å–®</button>
    </div>

    <div id="neuro" class="main-container active">
        <h2>åˆºæ¿€èˆ‡åæ‡‰ <span class="status-badge">æƒ…å¢ƒé¡Œåº«</span></h2>
        
        <div class="question-box" id="n-question">
            è¼‰å…¥ä¸­...
        </div>

        <div class="pathway-container">
            <div class="node" id="n1">å—å™¨</div> <div class="arrow">âœ</div>
            <div class="node" id="n2">æ„Ÿè¦º<br>ç¥ç¶“</div> <div class="arrow">âœ</div>
            <div class="node" id="n3">ä¸­æ¨<br>(?)</div> <div class="arrow">âœ</div>
            <div class="node" id="n4">é‹å‹•<br>ç¥ç¶“</div> <div class="arrow">âœ</div>
            <div class="node" id="n5">å‹•å™¨</div>
        </div>

        <div style="text-align:center;">
            <p style="color:#666; font-size:0.9rem;">è«‹é¸æ“‡åæ‡‰é¡å‹èˆ‡ä¸­æ¨ï¼š</p>
            <button class="action-btn btn-blue" onclick="checkNeuro('brain')">ğŸ§  æ„è­˜ (å¤§è…¦)</button>
            <button class="action-btn btn-red" onclick="checkNeuro('spine')">âš¡ åå°„ (è„Šé«“)</button>
        </div>
        <div class="feedback-area" id="n-feedback"></div>
        <button class="next-btn" id="next-n" onclick="genNeuro()">â¡ï¸ ä¸‹ä¸€é¡Œ (Next)</button>
    </div>

    <div id="hormone" class="main-container">
        <h2>å…§åˆ†æ³Œè¨ºæ‰€ <span class="status-badge">è¨ºæ–·æ¨¡å¼</span></h2>
        <div class="question-box">
            è«‹æ ¹æ“šç—…å¾µï¼Œé–‹ç«‹è¨ºæ–·è­‰æ˜æ›¸ã€‚
        </div>

        <div class="chart-grid">
            <div class="patient-card">
                <div class="patient-face" id="h-face">ğŸ˜</div>
                <div class="symptom-list" id="h-symptoms">
                    ç—‡ç‹€è¼‰å…¥ä¸­...
                </div>
            </div>
            <div class="diagnosis-panel">
                <div style="font-weight:bold; margin-bottom:5px;">æ¿€ç´ åŸå› ï¼š</div>
                <button class="action-btn btn-dark" onclick="selectHormone('gh')">ç”Ÿé•·æ¿€ç´  (Growth)</button>
                <button class="action-btn btn-dark" onclick="selectHormone('th')">ç”²ç‹€è…ºç´  (Thyroid)</button>
                <button class="action-btn btn-dark" onclick="selectHormone('ins')">èƒ°å³¶ç´  (Insulin)</button>
                
                <div style="font-weight:bold; margin:15px 0 5px 0;">åˆ†æ³Œç‹€æ…‹ï¼š</div>
                <div style="display:flex; justify-content:center;">
                    <button class="action-btn btn-blue" onclick="checkHormone('high')">â¬†ï¸ éå¤š (High)</button>
                    <button class="action-btn btn-red" onclick="checkHormone('low')">â¬‡ï¸ ä¸è¶³ (Low)</button>
                </div>
            </div>
        </div>
        <div class="feedback-area" id="h-feedback"></div>
        <button class="next-btn" id="next-h" onclick="genHormone()">â¡ï¸ ä¸‹ä¸€ä½ç—…äºº (Next)</button>
    </div>

    <div id="plant" class="main-container">
        <h2>æ¤ç‰©æ„Ÿæ‡‰å¯¦é©—å®¤ <span class="status-badge">é æ¸¬æ¨¡å¼</span></h2>
        <div class="question-box" id="p-question">
            å¯¦é©—æº–å‚™ä¸­...
        </div>

        <div class="plant-stage">
            <div class="seed-group" id="seed-group">
                <div class="seed"></div>
                <div id="stem" class="stem"></div>
                <div id="root" class="root"></div>
            </div>
        </div>

        <div style="text-align:center;">
            <p>è«‹å• <b>è– (ç¶ è‰²)</b> çš„ç”Ÿé•·æ–¹å‘ï¼Ÿ</p>
            <button class="action-btn btn-green" onclick="checkPlant('up')">â¬†ï¸ å‘ä¸Š (èƒŒåœ°/å‘å…‰)</button>
            <button class="action-btn btn-green" onclick="checkPlant('down')">â¬‡ï¸ å‘ä¸‹ (å‘åœ°/èƒŒå…‰)</button>
            <button class="action-btn btn-green" onclick="checkPlant('straight')">â¡ï¸ ç›´ç›´é•· (ç„¡å½±éŸ¿)</button>
        </div>
        <div class="feedback-area" id="p-feedback"></div>
        <button class="next-btn" id="next-p" onclick="genPlant()">â¡ï¸ ä¸‹ä¸€å€‹å¯¦é©— (Next)</button>
    </div>

    <div class="brand-watermark">STEM INSIGHT | ç”Ÿç‰©è‡ªå‹•åŒ–é¡Œåº«</div>

    <script>
        function switchScene(id) {
            document.querySelectorAll('.main-container').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
        }

        /* ========================
           1. ç¥ç¶“ç³»çµ±é¡Œåº«èˆ‡é‚è¼¯
           ======================== */
        const neuroBank = [
            { text: "æ‰‹ç¢°åˆ°ç†±é‹ï¼Œç«‹åˆ»ç¸®å›", type: "spine", desc: "è„Šé«“åå°„ (ä¿è­·æ©Ÿåˆ¶)" },
            { text: "çœ‹åˆ°èšŠå­åœåœ¨æ‰‹ä¸Šï¼Œç”¨åŠ›æ‰“ä¸‹å»", type: "brain", desc: "å¤§è…¦æ„è­˜ (è¦–è¦ºåˆ¤æ–·)" },
            { text: "è…³è¸©åˆ°å°–éŠ³ç‰©ï¼Œé¦¬ä¸ŠæŠŠè…³ç¸®èµ·", type: "spine", desc: "è„Šé«“åå°„ (ç—›è¦ºä¿è­·)" },
            { text: "è½åˆ°ä¸Šèª²é˜è²ï¼Œèµ°å›æ•™å®¤", type: "brain", desc: "å¤§è…¦æ„è­˜ (è½è¦ºåˆ¤æ–·)" },
            { text: "èåˆ°é¦™å‘³ï¼Œæ„Ÿè¦ºè‚šå­é¤“äº†", type: "brain", desc: "å¤§è…¦æ„è­˜ (å—…è¦ºåˆ¤æ–·)" }
        ];
        let currentNeuro = {};

        function genNeuro() {
            document.getElementById('next-n').style.display = 'none';
            document.getElementById('n-feedback').innerHTML = "";
            
            // é‡ç½®å‹•ç•«
            document.querySelectorAll('.node').forEach(n => n.classList.remove('active'));
            document.getElementById('n3').innerHTML = "ä¸­æ¨<br>(?)";

            // éš¨æ©Ÿé¸é¡Œ
            currentNeuro = neuroBank[Math.floor(Math.random() * neuroBank.length)];
            document.getElementById('n-question').innerText = "æƒ…å¢ƒï¼š" + currentNeuro.text;
        }

        async function checkNeuro(ans) {
            const fb = document.getElementById('n-feedback');
            const nodes = ['n1', 'n2', 'n3', 'n4', 'n5'];
            
            // æ’­æ”¾è·¯å¾‘å‹•ç•«
            for(let id of nodes) {
                document.getElementById(id).classList.add('active');
                await new Promise(r => setTimeout(r, 150));
                if(id !== 'n3' && id !== 'n5') document.getElementById(id).classList.remove('active');
            }

            if (ans === currentNeuro.type) {
                fb.innerHTML = `<span style="color:var(--accent)">âœ… æ­£ç¢ºï¼é€™æ˜¯ ${currentNeuro.desc}</span>`;
                document.getElementById('n3').innerHTML = ans === 'brain' ? "å¤§è…¦" : "è„Šé«“";
                document.getElementById('n3').style.color = "var(--primary)";
                document.getElementById('next-n').style.display = 'block';
            } else {
                fb.innerHTML = `<span style="color:var(--hormone)">âŒ éŒ¯èª¤ã€‚å†æƒ³æƒ³ä¸­æ¨æ˜¯èª°ï¼Ÿ</span>`;
                // é‡ç½®
                setTimeout(() => { document.querySelectorAll('.node').forEach(n => n.classList.remove('active')); }, 1000);
            }
        }

        /* ========================
           2. å…§åˆ†æ³Œé¡Œåº«èˆ‡é‚è¼¯
           ======================== */
        const hormoneBank = [
            { id: "gh_high", face: "ğŸ˜²", sym: "1. èº«é«˜ç•°å¸¸é«˜å¤§ (200cm+)<br>2. éª¨éª¼éåº¦ç”Ÿé•·<br>3. ç™¼ç”Ÿæ–¼ç”Ÿé•·ç™¼è‚²æœŸ", hormone: "gh", level: "high", name: "å·¨äººç—‡" },
            { id: "gh_low", face: "ğŸ‘¶", sym: "1. èº«é«˜åœæ»¯ä¸é•·<br>2. æ™ºåŠ›ç™¼å±•æ­£å¸¸<br>3. èº«ææ¯”ä¾‹å‹»ç¨±", hormone: "gh", level: "low", name: "ä¾å„’ç—‡" },
            { id: "th_high", face: "ğŸ‘€", sym: "1. é«”é‡æ¸›è¼•ã€é£Ÿæ…¾å¤§å¢<br>2. å®¹æ˜“ç·Šå¼µã€å¤±çœ <br>3. çœ¼çƒçªå‡ºã€æ€•ç†±", hormone: "th", level: "high", name: "ç”²ç‹€è…ºäº¢é€²" },
            { id: "ins_low", face: "ğŸœ", sym: "1. å°¿æ¶²æœƒå¼•ä¾†èèŸ»<br>2. å®¹æ˜“å£æ¸´ã€é »å°¿<br>3. é£¯å¾Œè¡€ç³–ç„¡æ³•ä¸‹é™", hormone: "ins", level: "low", name: "ç³–å°¿ç—…" }
        ];
        let currentHormone = {};
        let selectedH = "";

        function genHormone() {
            document.getElementById('next-h').style.display = 'none';
            document.getElementById('h-feedback').innerHTML = "";
            selectedH = "";
            
            currentHormone = hormoneBank[Math.floor(Math.random() * hormoneBank.length)];
            
            document.getElementById('h-face').innerText = currentHormone.face;
            document.getElementById('h-symptoms').innerHTML = currentHormone.sym;
        }

        function selectHormone(h) {
            selectedH = h;
            document.getElementById('h-feedback').innerText = "å·²é¸æ“‡æ¿€ç´ ï¼Œè«‹åˆ¤æ–·åˆ†æ³Œé‡...";
        }

        function checkHormone(lvl) {
            const fb = document.getElementById('h-feedback');
            if(!selectedH) { fb.innerText = "âš ï¸ è«‹å…ˆé»é¸ä¸Šæ–¹çš„æ¿€ç´ ç¨®é¡ï¼"; return; }

            if(selectedH === currentHormone.hormone && lvl === currentHormone.level) {
                fb.innerHTML = `<span style="color:var(--accent)">âœ… è¨ºæ–·æ­£ç¢ºï¼é€™æ˜¯ã€${currentHormone.name}ã€‘</span>`;
                document.getElementById('next-h').style.display = 'block';
            } else {
                fb.innerHTML = `<span style="color:var(--hormone)">âŒ èª¤è¨ºï¼è«‹é‡æ–°æª¢æŸ¥ç—…å¾µã€‚</span>`;
            }
        }

        /* ========================
           3. æ¤ç‰©æ„Ÿæ‡‰é¡Œåº«
           ======================== */
        const plantBank = [
            { type: "geo", text: "å°‡ç›†æ ½ã€Œæ°´å¹³å€’æ”¾ã€ä¸€æ®µæ™‚é–“å¾Œ...", ans: "up", reason: "èƒŒåœ°æ€§ (è–)" },
            { type: "light", text: "å…‰æºåªå¾ã€Œæ­£ä¸Šæ–¹ã€ç…§å°„...", ans: "straight", reason: "ç”Ÿé•·ç´ åˆ†å¸ƒå‡å‹»" },
            // ç‚ºäº†ç°¡åŒ–è¦–è¦ºï¼Œé€™è£¡ä¸»è¦è€ƒå‘åœ°èˆ‡åŸºæœ¬å…‰ç…§
        ];
        let currentPlant = {};

        function genPlant() {
            document.getElementById('next-p').style.display = 'none';
            document.getElementById('p-feedback').innerHTML = "";
            
            // é‡ç½®æ¤ç‰©å‹•ç•«
            document.getElementById('stem').style.transform = "rotate(0deg)";
            document.getElementById('stem').style.borderRadius = "0 10px 10px 0";
            document.getElementById('root').style.transform = "rotate(0deg)";
            document.getElementById('root').style.borderRadius = "10px 0 0 10px";

            currentPlant = plantBank[Math.floor(Math.random() * plantBank.length)];
            document.getElementById('p-question').innerText = "å¯¦é©—æ¢ä»¶ï¼š" + currentPlant.text;
        }

        function checkPlant(ans) {
            const fb = document.getElementById('p-feedback');
            
            if(ans === currentPlant.ans) {
                fb.innerHTML = `<span style="color:var(--accent)">âœ… é æ¸¬æ­£ç¢ºï¼åŸå› ï¼š${currentPlant.reason}</span>`;
                
                // å‹•ç•«æ¼”ç¤ºçµæœ
                if(ans === 'up') {
                    document.getElementById('stem').style.transform = "rotate(-45deg)";
                    document.getElementById('stem').style.borderRadius = "0 0 50px 0";
                    document.getElementById('root').style.transform = "rotate(-45deg)"; // æ ¹å‘åœ°
                    document.getElementById('root').style.borderRadius = "0 0 0 50px";
                }
                document.getElementById('next-p').style.display = 'block';
            } else {
                fb.innerHTML = `<span style="color:var(--hormone)">âŒ é æ¸¬éŒ¯èª¤ã€‚ç”Ÿé•·ç´ åˆ†ä½ˆæœƒå¦‚ä½•å½±éŸ¿ï¼Ÿ</span>`;
            }
        }

        // åˆå§‹åŒ–
        genNeuro();
        genHormone();
        genPlant();

    </script>
</body>
</html>