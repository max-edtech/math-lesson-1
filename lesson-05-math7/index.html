<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ä¸ƒå¹´ç´šæ•¸å­¸ | æ–¹ç¨‹å¼å¯¦æˆ° (Final Unblocked)</title>
    <style>
        :root { --primary: #3498db; --danger: #e74c3c; --success: #2ecc71; --dark: #2c3e50; --bg: #f5f7fa; }
        body { font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        .brand-watermark { position: fixed; bottom: 20px; right: 20px; background: rgba(26, 42, 108, 0.8); color: white; padding: 8px 15px; border-radius: 50px; font-size: 12px; pointer-events: none; z-index: 1000; }
        
        .tabs { display: flex; width: 100%; background: white; padding: 15px 0; justify-content: center; gap: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); z-index: 100; position: relative; }
        .tab-btn { background: #eee; color: #555; border: none; padding: 10px 25px; cursor: pointer; font-size: 1rem; border-radius: 50px; font-weight: bold; transition: 0.2s; }
        .tab-btn.active { background: var(--dark); color: white; transform: scale(1.05); }

        .container { width: 95%; max-width: 900px; background: white; margin-top: 20px; border-radius: 15px; padding: 30px; display: none; min-height: 600px; padding-bottom: 50px; margin-bottom: 50px; }
        .container.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { margin-top: 0; color: var(--dark); border-bottom: 2px solid #eee; padding-bottom: 10px; }

        /* --- å¤©å¹³å€ (ç„¡é®æ“‹ä¿®æ­£) --- */
        .balance-wrapper {
            position: relative; 
            width: 100%; 
            height: 400px; /* åŠ é«˜é«˜åº¦ */
            background: linear-gradient(to bottom, #fdfdfd, #f1f1f1); 
            border: 1px solid #ddd; 
            border-radius: 10px; 
            margin-top: 20px; 
            /* ç§»é™¤ overflow: hidden ä»¥å…åˆ‡åˆ°ç›¤å­ */
            overflow: visible; 
        }

        /* çµæœå½ˆçª—æ°£æ³¡ (Result Bubble) */
        .result-bubble {
            position: absolute;
            top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            z-index: 999;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none; /* è®“é»æ“Šç©¿é€ */
            border: 4px solid var(--dark);
        }
        .result-bubble.show { transform: translate(-50%, -50%) scale(1); }
        .result-bubble.correct { border-color: var(--success); color: var(--success); }
        .result-bubble.wrong { border-color: var(--danger); color: var(--danger); }

        /* æ”¯é»ï¼šæé«˜ä½ç½® */
        .pivot {
            position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 30px solid transparent; border-right: 30px solid transparent; border-bottom: 60px solid var(--dark); z-index: 2;
        }
        /* æ©«æ¡¿ï¼šå°æ‡‰æ”¯é»å°–ç«¯ (80+60=140) */
        .beam-container {
            position: absolute; width: 500px; height: 12px; background: var(--dark); border-radius: 6px;
            bottom: 140px; left: 50%; margin-left: -250px;
            transform-origin: 50% 50%; transition: transform 0.8s cubic-bezier(0.5, 1.5, 0.5, 1); z-index: 3;
        }
        .beam-container.tilt-cw { transform: rotate(15deg); }
        
        .string { width: 4px; height: 100px; background: #95a5a6; position: absolute; top: 6px; }
        .string.left { left: 20px; } .string.right { right: 20px; }
        
        .pan {
            width: 140px; height: 100px; border: 4px solid var(--dark); border-top: none;
            background: rgba(255,255,255,0.95); position: absolute; top: 100px; left: 50%; transform: translateX(-50%);
            display: flex; flex-wrap: wrap-reverse; justify-content: center; align-content: flex-start; padding: 8px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .block-x { width: 32px; height: 32px; background: var(--danger); color: white; margin: 3px; display: flex; align-items: center; justify-content: center; font-weight: bold; border-radius: 4px; box-shadow: 2px 2px 0 rgba(0,0,0,0.1); border: 1px solid #c0392b; }
        .block-1 { width: 24px; height: 24px; background: var(--primary); color: white; margin: 3px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; border: 1px solid #2980b9; transition: 0.5s; box-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
        .vanish { opacity: 0; transform: scale(0); }

        /* --- åˆ†æ•¸å€ --- */
        .complex-frac-box { font-size: 1.8rem; text-align: center; margin: 30px 0; font-family: 'Times New Roman', serif; }
        .frac { display: inline-block; vertical-align: middle; text-align: center; }
        .frac .top { border-bottom: 2px solid black; display: block; padding: 0 5px; }
        .frac .btm { display: block; padding: 2px 0; }
        .step-row { 
            background: #fff; border: 2px solid #eee; padding: 15px; border-radius: 10px; 
            font-size: 1.4rem; font-weight: bold; width: 80%; text-align: center; margin: 10px auto;
            opacity: 0.3; transition: 0.5s; transform: translateY(10px);
        }
        .step-row.active { opacity: 1; transform: translateY(0); border-color: var(--primary); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .highlight-red { color: var(--danger); font-weight: bold; }

        /* --- ç¿»è­¯æ©Ÿå€ --- */
        .wp-box { background: #fffbe6; padding: 20px; border-left: 6px solid #f1c40f; font-size: 1.4rem; line-height: 1.8; border-radius: 8px; }
        .key-text { border-bottom: 3px solid #ccc; cursor: pointer; padding: 0 4px; }
        .key-text:hover { background: rgba(0,0,0,0.05); }
        .key-text.filled { background: var(--success); color: white; border-color: transparent; border-radius: 4px; }
        .slot-row { display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap; background: var(--dark); padding: 15px; border-radius: 10px; color: white; align-items: center; justify-content: center; }
        .slot { width: 60px; height: 45px; border: 2px dashed #7f8c8d; display: flex; align-items: center; justify-content: center; cursor: pointer; background: rgba(255,255,255,0.1); font-size: 1.2rem; }
        .slot.filled { background: white; color: var(--dark); border-style: solid; }

        /* æŒ‰éˆ•æ¨£å¼ */
        .action-btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; font-weight: bold; margin: 10px; color: white; transition: 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .action-btn:active { transform: scale(0.95); }
        .btn-r { background: var(--danger); } .btn-g { background: var(--success); } .btn-b { background: #3498db; } .btn-y { background: #f39c12; color: #333; }
    </style>
</head>
<body>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('balance')">âš–ï¸ å¤©å¹³ (ç­‰é‡å…¬ç†)</button>
        <button class="tab-btn" onclick="switchTab('fraction')">ğŸ’£ è¤‡é›œåˆ†æ•¸ (å»åˆ†æ¯)</button>
        <button class="tab-btn" onclick="switchTab('word')">ğŸ“ ç¿»è­¯æ©Ÿ (æ‡‰ç”¨é¡Œ)</button>
    </div>

    <div id="balance" class="container active">
        <h2>ç­‰é‡å…¬ç†ï¼šå¤©å¹³å¯¦é©—</h2>
        <div style="text-align:center; font-size:2rem; font-weight:bold; margin-bottom:10px;">
            <span id="eq-l">2x + 6</span> = <span id="eq-r">10</span>
        </div>
        
        <div class="balance-wrapper">
            <div id="bubble" class="result-bubble"></div> <div class="beam-container" id="beam">
                <div class="string left"><div class="pan" id="pan-left"></div></div>
                <div class="string right"><div class="pan" id="pan-right"></div></div>
            </div>
            <div class="pivot"></div>
        </div>
        
        <div style="text-align:center; margin-top:30px;">
            <button class="action-btn btn-r" onclick="wrongMove()">âŒ éŒ¯èª¤ï¼šåªæ¸›å·¦é‚Š</button>
            <button class="action-btn btn-g" onclick="correctMove()">â­• æ­£ç¢ºï¼šåŒæ™‚æ¸› 6</button>
            <button class="action-btn btn-y" onclick="initBalance()">ğŸ”„ é‡ç½®</button>
        </div>
    </div>

    <div id="fraction" class="container">
        <h2>è¤‡é›œåˆ†æ•¸ï¼šå»åˆ†æ¯èˆ‡æ‹¬è™Ÿ</h2>
        <div class="complex-frac-box">
            <span class="frac"><span class="top">2x + 5</span><span class="btm">3</span></span>
            - <span class="frac"><span class="top">x - 2</span><span class="btm">2</span></span>
            = 2
        </div>
        <div style="text-align:center;">
            <button class="action-btn btn-b" onclick="fracStep(1)">Step 1: åŒä¹˜ 6</button>
            <button class="action-btn btn-b" onclick="fracStep(2)">Step 2: æ‹¬è™Ÿ</button>
            <button class="action-btn btn-r" onclick="fracStep(3)">Step 3: æ‹†æ‹¬è™Ÿ</button>
            <button class="action-btn btn-y" onclick="fracReset()">é‡ç½®</button>
        </div>
        <div id="fs1" class="step-row">6 Ã— (å·¦å¼) = 6 Ã— 2</div>
        <div id="fs2" class="step-row">2(2x+5) - 3<span class="highlight-red">(x-2)</span> = 12</div>
        <div id="fs3" class="step-row">4x + 10 - 3x <span class="highlight-red">+ 6</span> = 12</div>
    </div>

    <div id="word" class="container">
        <h2>é¡Œæ„ç¿»è­¯æ©Ÿ</h2>
        <div class="wp-box">
            é¡Œç›®ï¼šçˆ¸çˆ¸çš„å¹´é½¡ <span class="key-text" onclick="fillSlot(0, '=')">æ˜¯</span> 
            å…’å­çš„ <span class="key-text" onclick="fillSlot(1, '3x')">3å€</span> 
            <span class="key-text" onclick="fillSlot(2, '-')">å°‘</span> 5 æ­²ã€‚
            <br><span style="font-size:0.9rem; color:#666;">(è¨­å…’å­ xï¼Œçˆ¸çˆ¸ y)</span>
        </div>
        <div class="slot-row">
            <span style="font-size:1.5rem; font-weight:bold;">y</span>
            <div class="slot" id="s0" onclick="clearSlot(0)"></div>
            <div class="slot" id="s1" onclick="clearSlot(1)"></div>
            <div class="slot" id="s2" onclick="clearSlot(2)"></div>
            <div class="slot filled" style="border:none;">5</div>
        </div>
        <div style="margin-top:20px; text-align:center;">
            <button class="action-btn btn-b" onclick="manualFill('+')">+</button>
            <button class="action-btn btn-b" onclick="manualFill('-')">-</button>
            <button class="action-btn btn-b" onclick="manualFill('=')">=</button>
            <button class="action-btn btn-b" onclick="manualFill('3x')">3x</button>
            <button class="action-btn btn-g" onclick="checkWp()">âœ… æª¢æŸ¥</button>
        </div>
        <p id="wp-msg" style="text-align:center; font-weight:bold; margin-top:10px; font-size:1.5rem;"></p>
    </div>

    <div class="brand-watermark">STEM INSIGHT</div>

    <script>
        function switchTab(id) {
            document.querySelectorAll('.container').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
        }

        // --- å¤©å¹³é‚è¼¯ ---
        function showBubble(text, type) {
            const b = document.getElementById('bubble');
            b.innerText = text;
            b.className = "result-bubble show " + type;
            setTimeout(() => b.classList.remove('show'), 2000); // 2ç§’å¾Œè‡ªå‹•æ¶ˆå¤±
        }

        function initBalance() {
            const l = document.getElementById('pan-left');
            const r = document.getElementById('pan-right');
            l.innerHTML = ''; r.innerHTML = '';
            for(let i=0; i<2; i++) l.innerHTML += `<div class="block-x">X</div>`;
            for(let i=0; i<6; i++) l.innerHTML += `<div class="block-1">1</div>`;
            for(let i=0; i<10; i++) r.innerHTML += `<div class="block-1">1</div>`;
            document.getElementById('beam').className = 'beam-container';
            document.getElementById('eq-l').innerText = "2x + 6";
            document.getElementById('eq-r').innerText = "10";
            document.querySelectorAll('.block-1').forEach(el => el.style.opacity = '1');
            document.getElementById('bubble').classList.remove('show');
        }

        function wrongMove() {
            document.getElementById('beam').className = 'beam-container tilt-cw'; 
            showBubble("âš ï¸ æ­ªäº†ï¼åªæ¸›ä¸€é‚Šæ˜¯ä¸è¡Œçš„ï¼", "wrong");
            document.querySelectorAll('#pan-left .block-1').forEach(el => el.style.opacity = '0.3');
        }

        function correctMove() {
            document.getElementById('beam').className = 'beam-container';
            showBubble("ğŸ‰ å¹³è¡¡ï¼å…©é‚ŠåŒæ™‚æ¸› 6", "correct");
            const l = document.querySelectorAll('#pan-left .block-1');
            const r = document.querySelectorAll('#pan-right .block-1');
            for(let i=0; i<6; i++) { if(l[i]) l[i].classList.add('vanish'); if(r[i]) r[i].classList.add('vanish'); }
            setTimeout(() => { document.getElementById('eq-l').innerText = "2x"; document.getElementById('eq-r').innerText = "4"; }, 500);
        }
        initBalance();

        // --- åˆ†æ•¸é‚è¼¯ ---
        function fracStep(step) {
            document.querySelectorAll('.step-row').forEach(el => el.classList.remove('active'));
            for(let i=1; i<=step; i++) {
                setTimeout(() => document.getElementById('fs'+i).classList.add('active'), (i-1)*200);
            }
        }
        function fracReset() { document.querySelectorAll('.step-row').forEach(el => el.classList.remove('active')); }

        // --- ç¿»è­¯æ©Ÿé‚è¼¯ ---
        function fillSlot(idx, val) {
            for(let i=0; i<3; i++) {
                let s = document.getElementById('s'+i);
                if(!s.classList.contains('filled')) { s.innerText = val; s.classList.add('filled'); return; }
            }
        }
        function manualFill(val) { fillSlot(0, val); }
        function clearSlot(idx) {
            let s = document.getElementById('s'+idx); s.innerText = ''; s.classList.remove('filled');
            document.getElementById('wp-msg').innerText = "";
        }
        function checkWp() {
            const v0 = document.getElementById('s0').innerText;
            const v1 = document.getElementById('s1').innerText;
            const v2 = document.getElementById('s2').innerText;
            const msg = document.getElementById('wp-msg');
            if(v0 === '=' && v1 === '3x' && v2 === '-') {
                msg.innerText = "ğŸ‰ æ­£ç¢ºï¼ y = 3x - 5"; msg.style.color = "var(--success)";
            } else if(v0 === '=' && v1 === '-' && v2 === '3x') {
                msg.innerText = "âš ï¸ é™·é˜±ï¼ã€Œå°‘ 5ã€æ˜¯æ¸›åœ¨å¾Œé¢ï¼"; msg.style.color = "#e67e22";
            } else {
                msg.innerText = "âŒ é †åºä¸å°ï¼Œå†è©¦è©¦ï¼"; msg.style.color = "var(--danger)";
            }
        }
    </script>
</body>
</html>