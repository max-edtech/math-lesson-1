<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STEM INSIGHT | ç†åŒ–è§€å¿µå»ºæ§‹å®¤</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --fire: #e74c3c; --trap: #c0392b; --bg: #f4f6f7; --correct: #27ae60; --wrong: #e74c3c; }
        body { font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; display: flex; flex-direction: column; align-items: center; }
        
        /* é ‚éƒ¨å°èˆª */
        header { width: 100%; background: linear-gradient(135deg, #1a2a6c, #b21f1f); color: white; padding: 20px 0; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        h2 { margin: 0; font-weight: 300; letter-spacing: 2px; }
        
        /* TAB åˆ‡æ› */
        .tabs { display: flex; gap: 15px; margin: 25px 0; z-index: 10; flex-wrap: wrap; justify-content: center; }
        .tab-btn { padding: 12px 30px; border: none; background: white; border-radius: 50px; cursor: pointer; font-weight: bold; color: #555; box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.3s; display: flex; align-items: center; gap: 8px; font-size: 1rem; }
        .tab-btn.active { background: var(--accent); color: white; transform: translateY(-3px); box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4); }

        /* ä¸»å®¹å™¨ */
        .lab-container { width: 90%; max-width: 900px; background: white; border-radius: 20px; padding: 40px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); display: none; position: relative; overflow: hidden; min-height: 400px; }
        .lab-container.active { display: block; animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* --- 1. åŸå­å¯¦é©—å®¤ CSS --- */
        .atom-wrapper { display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; align-items: center; }
        .atom-visual { position: relative; width: 320px; height: 320px; }
        
        /* è»Œé“èˆ‡é›»å­ */
        .orbit { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border: 1px dashed #cbd5e0; border-radius: 50%; transition: 0.3s; }
        .orbit-k { width: 120px; height: 120px; }
        .orbit-l { width: 220px; height: 220px; }
        
        .electron { position: absolute; width: 14px; height: 14px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 8px var(--accent); transform-origin: center; }
        /* é›»å­å…¬è½‰å‹•ç•« */
        .orbit-k .electron-group { width: 100%; height: 100%; position: absolute; animation: spin 4s linear infinite; }
        .orbit-l .electron-group { width: 100%; height: 100%; position: absolute; animation: spin 8s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* åŸå­æ ¸ */
        .nucleus { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 70px; height: 70px; background: radial-gradient(circle, #e74c3c, #c0392b); border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; font-size: 13px; font-weight: bold; box-shadow: 0 0 20px rgba(231, 76, 60, 0.5); z-index: 5; transition: 0.3s; }
        .nucleus.wobble { animation: wobble 0.5s ease-in-out; }
        @keyframes wobble { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.2); } }

        /* æ§åˆ¶é¢æ¿ */
        .panel { background: #f8f9fa; padding: 20px; border-radius: 15px; width: 100%; max-width: 350px; }
        .ctrl-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        .ctrl-btn { width: 35px; height: 35px; border-radius: 50%; border: none; background: #e2e6ea; font-size: 18px; cursor: pointer; transition: 0.2s; }
        .ctrl-btn:hover { background: #dbe2ef; transform: scale(1.1); }
        .info-card { background: #e8f4fd; color: #2c3e50; padding: 15px; border-radius: 10px; margin-top: 15px; font-size: 0.9rem; border-left: 5px solid var(--accent); }

        /* --- 2. ç†±å­¸å¯¦é©—å®¤ CSS --- */
        .heat-experiment { display: flex; justify-content: space-around; align-items: flex-end; padding-top: 30px; height: 250px; border-bottom: 6px solid #555; position: relative; }
        
        .beaker-group { display: flex; flex-direction: column; align-items: center; position: relative; }
        .beaker { width: 100px; height: 140px; border: 4px solid #333; border-top: none; border-radius: 0 0 10px 10px; position: relative; background: rgba(255,255,255,0.8); overflow: hidden; }
        .liquid { width: 100%; position: absolute; bottom: 0; transition: height 0.5s; }
        
        .thermometer-wrapper { position: absolute; right: -25px; bottom: 0; height: 160px; width: 40px; display: flex; flex-direction: column; align-items: center; }
        .thermometer-tube { width: 8px; height: 100%; background: #eee; border-radius: 5px; position: relative; border: 1px solid #ccc; }
        .mercury { width: 100%; background: linear-gradient(to top, #e74c3c, #ff6b6b); position: absolute; bottom: 0; border-radius: 5px; transition: height 0.2s; height: 20%; }
        .temp-display { font-size: 14px; font-weight: bold; margin-bottom: 5px; color: #c0392b; }

        .burner { width: 80px; height: 40px; background: #555; margin-top: 5px; border-radius: 5px; position: relative; }
        .fire { position: absolute; top: -30px; left: 50%; transform: translateX(-50%); width: 40px; height: 40px; background: radial-gradient(circle, yellow, orange, transparent); opacity: 0; transition: 0.3s; border-radius: 50% 50% 20% 20%; filter: blur(2px); }
        .fire.active { opacity: 1; animation: flicker 0.2s infinite alternate; }
        @keyframes flicker { 0% { transform: translateX(-50%) scale(1); } 100% { transform: translateX(-50%) scale(1.1) translateY(-2px); } }

        .heat-controls { margin-top: 30px; text-align: center; }
        .btn-fire { background: var(--fire); color: white; padding: 15px 40px; font-size: 1.2rem; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4); transition: 0.2s; }
        .btn-fire:active { transform: scale(0.95); }
        .btn-reset { background: #7f8c8d; color: white; padding: 10px 20px; border: none; border-radius: 50px; cursor: pointer; margin-left: 10px; }

        /* --- 3. è§€å¿µæ¸¬é©— CSS --- */
        #quiz-start-screen { text-align: center; padding: 40px; }
        .quiz-title { font-size: 1.5rem; color: var(--primary); margin-bottom: 10px; }
        .quiz-desc { color: #666; margin-bottom: 30px; }
        .btn-start { background: var(--accent); color: white; padding: 15px 50px; border: none; border-radius: 50px; font-size: 1.2rem; cursor: pointer; transition: 0.3s; }
        .btn-start:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4); }

        .question-card { display: none; }
        .question-card.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .q-progress { color: #aaa; font-size: 0.9rem; margin-bottom: 10px; }
        .q-text { font-size: 1.3rem; font-weight: bold; color: var(--primary); margin-bottom: 25px; line-height: 1.4; }
        
        .options-grid { display: grid; gap: 15px; }
        .opt-btn { padding: 15px 20px; border: 2px solid #eee; background: white; border-radius: 10px; text-align: left; cursor: pointer; transition: 0.2s; font-size: 1rem; color: #444; }
        .opt-btn:hover { border-color: var(--accent); background: #f8fcfd; }
        
        /* ä½œç­”å¾Œæ¨£å¼ */
        .opt-btn.correct { background: #d4edda; border-color: var(--correct); color: #155724; }
        .opt-btn.wrong { background: #f8d7da; border-color: var(--wrong); color: #721c24; opacity: 0.7; }
        
        .feedback-box { margin-top: 20px; padding: 20px; border-radius: 10px; display: none; }
        .feedback-box.correct { background: #eafaf1; border-left: 5px solid var(--correct); }
        .feedback-box.wrong { background: #fdeaea; border-left: 5px solid var(--wrong); }
        
        .btn-next { float: right; margin-top: 15px; background: var(--primary); color: white; border: none; padding: 10px 30px; border-radius: 5px; cursor: pointer; display: none; }

        /* çµæœé  */
        #quiz-result-screen { text-align: center; display: none; }
        .score-circle { width: 150px; height: 150px; border-radius: 50%; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: bold; margin: 0 auto 20px; box-shadow: 0 10px 20px rgba(52,152,219,0.3); }

        /* --- é€šç”¨ï¼šé™·é˜±æŒ‰éˆ•èˆ‡å½ˆçª— --- */
        .trap-trigger { position: absolute; top: 20px; right: 20px; background: white; color: var(--trap); border: 2px solid var(--trap); padding: 8px 15px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; z-index: 5; display: flex; align-items: center; gap: 5px; }
        .trap-trigger:hover { background: var(--trap); color: white; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 100; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .modal-content { background: white; padding: 40px; border-radius: 20px; width: 90%; max-width: 550px; text-align: center; position: relative; border-top: 10px solid var(--trap); animation: popIn 0.4s; }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .close-modal { position: absolute; top: 10px; right: 20px; font-size: 30px; cursor: pointer; color: #999; }
        
        .trap-question { font-size: 1.4rem; font-weight: bold; margin-bottom: 20px; color: #2c3e50; line-height: 1.5; }
        .trap-answer { background: #f1f2f6; padding: 20px; border-radius: 10px; margin-top: 20px; display: none; text-align: left; }
        .reveal-btn { background: var(--trap); color: white; border: none; padding: 10px 25px; border-radius: 5px; font-size: 1.1rem; cursor: pointer; margin-top: 10px; }

    </style>
</head>
<body>

<header>
    <h2>ç†åŒ–è§€å¿µå»ºæ§‹å®¤ | STEM INSIGHT</h2>
    <p style="font-size:0.9rem; opacity:0.8; margin-top:5px;">é‡å° Peiyu è¨­è¨ˆï¼šåœ–å½¢è¨˜æ†¶ Ã— é‚è¼¯é™·é˜± Ã— è§€å¿µè¨ºæ–·</p>
</header>

<div class="tabs">
    <button class="tab-btn active" onclick="switchTab('atom')">âš›ï¸ åŸå­èˆ‡é›¢å­</button>
    <button class="tab-btn" onclick="switchTab('heat')">ğŸ”¥ æ¯”ç†±èˆ‡ç†±å¹³è¡¡</button>
    <button class="tab-btn" onclick="switchTab('quiz')">ğŸ“ è§€å¿µæŒ‘æˆ°</button>
</div>

<div id="atom" class="lab-container active">
    <button class="trap-trigger" onclick="openTrap('iso')">âš ï¸ é™·é˜±é¡Œï¼šä¸­å­å¤§æš´èµ°</button>
    
    <div class="atom-wrapper">
        <div class="atom-visual">
            <div class="orbit orbit-l"><div class="electron-group" id="shell-l"></div></div>
            <div class="orbit orbit-k"><div class="electron-group" id="shell-k"></div></div>
            <div class="nucleus" id="nucleus">
                <span id="p-disp">P:6</span>
                <span id="n-disp">N:6</span>
            </div>
        </div>

        <div class="panel">
            <h3 style="margin-top:0; border-bottom:2px solid #eee; padding-bottom:10px;">ç²’å­æ§åˆ¶å™¨</h3>
            <div class="ctrl-row">
                <label>âš›ï¸ è³ªå­ (P)</label>
                <div>
                    <button class="ctrl-btn" onclick="updateAtom('p', -1)">-</button>
                    <span id="p-val" style="margin:0 10px; font-weight:bold; width:20px; display:inline-block; text-align:center;">6</span>
                    <button class="ctrl-btn" onclick="updateAtom('p', 1)">+</button>
                </div>
            </div>
            <div class="ctrl-row">
                <label>ğŸŒ‘ ä¸­å­ (N)</label>
                <div>
                    <button class="ctrl-btn" onclick="updateAtom('n', -1)">-</button>
                    <span id="n-val" style="margin:0 10px; font-weight:bold; width:20px; display:inline-block; text-align:center;">6</span>
                    <button class="ctrl-btn" onclick="updateAtom('n', 1)">+</button>
                </div>
            </div>
            <div class="ctrl-row">
                <label>âš¡ é›»å­ (eâ»)</label>
                <div>
                    <button class="ctrl-btn" onclick="updateAtom('e', -1)">-</button>
                    <span id="e-val" style="margin:0 10px; font-weight:bold; width:20px; display:inline-block; text-align:center;">6</span>
                    <button class="ctrl-btn" onclick="updateAtom('e', 1)">+</button>
                </div>
            </div>
            <div class="info-card">
                <div style="font-size:1.5rem; font-weight:bold; color:var(--primary); display:flex; justify-content:space-between; align-items:center;">
                    <span id="chem-symbol">C</span>
                    <span id="charge-tag" style="font-size:0.8rem; background:#eee; padding:2px 8px; border-radius:4px;">é›»ä¸­æ€§</span>
                </div>
                <hr style="border:0; border-top:1px solid #ccc; margin:10px 0;">
                <div>åŸå­åºï¼š<span id="atomic-num">6</span></div>
                <div>è³ªé‡æ•¸ (P+N)ï¼š<span id="mass-num">12</span></div>
            </div>
        </div>
    </div>
</div>

<div id="heat" class="lab-container">
    <button class="trap-trigger" onclick="openTrap('mix')">âš ï¸ é™·é˜±é¡Œï¼šéµå¡Šä¸Ÿå†·æ°´</button>

    <div style="background:#fff3cd; padding:10px; border-radius:8px; text-align:center; margin-bottom:20px; color:#856404;">
        å…¬å¼è¨˜æ†¶ï¼š<strong>H (ç†±é‡) = m (è³ªé‡) Ã— s (æ¯”ç†±) Ã— Î”T (æº«å·®)</strong>
    </div>

    <div class="heat-experiment">
        <div class="beaker-group">
            <div class="temp-display"><span id="temp-water">20</span>Â°C</div>
            <div class="beaker">
                <div class="liquid" style="height:60%; background:rgba(52,152,219,0.5)"></div>
            </div>
            <div class="thermometer-wrapper">
                <div class="thermometer-tube"><div class="mercury" id="merc-water"></div></div>
            </div>
            <div class="burner"><div class="fire" id="fire-water"></div></div>
            <div style="margin-top:10px; font-weight:bold;">æ°´ (100g)</div>
            <div style="font-size:0.8rem; color:#666;">æ¯”ç†± S=1.0</div>
        </div>

        <div class="beaker-group">
            <div class="temp-display"><span id="temp-oil">20</span>Â°C</div>
            <div class="beaker">
                <div class="liquid" style="height:60%; background:rgba(241,196,15,0.5)"></div>
            </div>
            <div class="thermometer-wrapper">
                <div class="thermometer-tube"><div class="mercury" id="merc-oil"></div></div>
            </div>
            <div class="burner"><div class="fire" id="fire-oil"></div></div>
            <div style="margin-top:10px; font-weight:bold;">æ²¹ (100g)</div>
            <div style="font-size:0.8rem; color:#666;">æ¯”ç†± S=0.5 (æ˜“ç†±æ˜“å†·)</div>
        </div>
    </div>

    <div class="heat-controls">
        <button class="btn-fire" onmousedown="startHeating()" onmouseup="stopHeating()" onmouseleave="stopHeating()">ğŸ”¥ æŒ‰ä½é»ç«åŠ ç†±</button>
        <button class="btn-reset" onclick="resetHeat()">é‡ç½®æº«åº¦</button>
        <p style="color:#777; margin-top:10px; font-size:0.9rem;">è§€å¯Ÿï¼šèª°çš„æº«åº¦è¡å¾—æ¯”è¼ƒå¿«ï¼Ÿç‚ºä»€éº¼ï¼Ÿ</p>
    </div>
</div>

<div id="quiz" class="lab-container">
    <div id="quiz-start-screen">
        <div class="quiz-title">ç†åŒ–è§€å¿µè¨ºæ–·ï¼šç†±èˆ‡åŸå­</div>
        <p class="quiz-desc">å…± 10 é¡Œï¼Œé‡å°æ²›å¦¤å®¹æ˜“æ··æ·†çš„ã€Œé™·é˜±ã€è¨­è¨ˆã€‚<br>è«‹ä»”ç´°é–±è®€é¡Œç›®ï¼Œä¸è¦æ‰é€²é™·é˜±è£¡å–”ï¼</p>
        <button class="btn-start" onclick="startQuiz()">é–‹å§‹æŒ‘æˆ°</button>
    </div>

    <div id="quiz-question-screen" style="display:none;">
        <div class="q-progress">Question <span id="q-idx">1</span> / 10</div>
        <div class="q-text" id="q-text">é¡Œç›®æ–‡å­—è¼‰å…¥ä¸­...</div>
        
        <div class="options-grid" id="opt-container">
            </div>

        <div class="feedback-box" id="feedback-box">
            <h4 style="margin-top:0;" id="fb-title">è§£æ</h4>
            <div id="fb-text"></div>
        </div>
        
        <button class="btn-next" id="btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â”</button>
    </div>

    <div id="quiz-result-screen">
        <div class="score-circle" id="final-score">80</div>
        <h3>æ¸¬é©—çµæŸï¼</h3>
        <p id="score-msg">è§€å¿µé‚„ä¸éŒ¯å–”ï¼Œå°å¿ƒå¹¾å€‹é™·é˜±å°±å¥½ï¼</p>
        <button class="btn-reset" onclick="location.reload()">é‡æ–°æ•´ç†</button>
    </div>
</div>

<div id="modal-iso" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeAllModals()">&times;</span>
        <h3 style="color:var(--trap)">ğŸ’€ è§€å¿µé™·é˜±å€</h3>
        <p class="trap-question">å¦‚æœæˆ‘åœ¨åŸå­æ ¸è£¡ä¸€ç›´å¡ã€Œä¸­å­ã€ï¼Œ<br>é€™å€‹å…ƒç´ æœƒè®Šæˆåˆ¥ç¨®å…ƒç´ å—ï¼Ÿ</p>
        <button class="reveal-btn" onclick="revealAnswer('iso')">é»æˆ‘çœ‹çµæœ</button>
        <div id="ans-iso" class="trap-answer">
            <h4 style="color:var(--accent); margin-top:0;">ç­”æ¡ˆï¼šä¸æœƒï¼</h4>
            <p>å› ç‚º<strong>ã€Œè³ªå­æ•¸ (P)ã€æ‰æ˜¯å…ƒç´ çš„èº«ä»½è­‰</strong>ã€‚</p>
            <p>å¢åŠ ä¸­å­åªæœƒè®“å®ƒè®Šé‡ï¼ˆè®Šæˆ<strong>åŒä½ç´ </strong>ï¼‰ï¼Œä½†å®ƒä¾ç„¶æ˜¯ç¢³ (C)ï¼</p>
        </div>
    </div>
</div>

<div id="modal-mix" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeAllModals()">&times;</span>
        <h3 style="color:var(--trap)">ğŸ’€ è§€å¿µé™·é˜±å€</h3>
        <p class="trap-question">100g çš„ 80Â°C éµå¡Šï¼Œä¸Ÿé€² 100g çš„ 20Â°C å†·æ°´ã€‚<br>æœ€å¾Œæº«åº¦æœƒæ˜¯ä¸­é–“å€¼ (50Â°C) å—ï¼Ÿ</p>
        <button class="reveal-btn" onclick="revealAnswer('mix')">é»æˆ‘çœ‹çµæœ</button>
        <div id="ans-mix" class="trap-answer">
            <h4 style="color:var(--accent); margin-top:0;">ç­”æ¡ˆï¼šçµ•å°ä¸åˆ° 50Â°Cï¼(ç´„ 25Â°C)</h4>
            <p>ç‚ºä»€éº¼ï¼Ÿå› ç‚º<strong>éµçš„æ¯”ç†± (S=0.113) å¤ªå°äº†ï¼</strong></p>
            <p>éµå¡Šå¸¶çš„ç†±é‡å¾ˆå°‘ï¼Œæ ¹æœ¬ç„¡æ³•æŠŠæ°´åŠ ç†±å¤ªå¤šã€‚</p>
        </div>
    </div>
</div>

<script>
    // --- é ç±¤åˆ‡æ› ---
    function switchTab(id) {
        document.querySelectorAll('.lab-container').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        event.target.classList.add('active');
    }

    function openTrap(type) {
        document.getElementById('modal-' + type).style.display = 'flex';
        document.getElementById('ans-' + type).style.display = 'none';
    }

    function closeAllModals() {
        document.querySelectorAll('.modal').forEach(el => el.style.display = 'none');
    }

    function revealAnswer(type) {
        document.getElementById('ans-' + type).style.display = 'block';
    }

    // ================= åŸå­é‚è¼¯ =================
    let p = 6, n = 6, e = 6;
    const elements = { 1:'H', 2:'He', 3:'Li', 4:'Be', 5:'B', 6:'C', 7:'N', 8:'O', 9:'F', 10:'Ne', 11:'Na' };

    function updateAtom(type, d) {
        if(type==='p') p = Math.max(1, Math.min(11, p+d));
        if(type==='n') n = Math.max(0, n+d);
        if(type==='e') e = Math.max(0, e+d);

        document.getElementById('p-val').innerText = p;
        document.getElementById('n-val').innerText = n;
        document.getElementById('e-val').innerText = e;
        document.getElementById('p-disp').innerText = "P:"+p;
        document.getElementById('n-disp').innerText = "N:"+n;
        document.getElementById('atomic-num').innerText = p;
        document.getElementById('mass-num').innerText = p + n;
        document.getElementById('chem-symbol').innerText = elements[p] || "X";

        const charge = p - e;
        const tag = document.getElementById('charge-tag');
        if(charge === 0) {
            tag.innerText = "é›»ä¸­æ€§"; tag.style.background = "#eee"; tag.style.color = "#333";
        } else if (charge > 0) {
            tag.innerText = "é™½é›¢å­ (+" + charge + ")"; tag.style.background = "#ffeaa7"; tag.style.color = "#d35400";
        } else {
            tag.innerText = "é™°é›¢å­ (" + charge + ")"; tag.style.background = "#81ecec"; tag.style.color = "#00cec9";
        }
        updateElectronVisuals();
        
        if(type === 'n') {
            const nucl = document.getElementById('nucleus');
            nucl.classList.remove('wobble');
            void nucl.offsetWidth;
            nucl.classList.add('wobble');
        }
    }

    function updateElectronVisuals() {
        let k_count = Math.min(e, 2);
        let l_count = Math.max(0, e - 2);
        renderOrbit('shell-k', k_count, 60);
        renderOrbit('shell-l', l_count, 110);
    }

    function renderOrbit(id, count, radius) {
        const container = document.getElementById(id);
        container.innerHTML = '';
        for(let i=0; i<count; i++) {
            let el = document.createElement('div');
            el.className = 'electron';
            let angle = (360 / count) * i;
            let rad = angle * (Math.PI / 180);
            let x = Math.cos(rad) * radius;
            let y = Math.sin(rad) * radius;
            el.style.left = `calc(50% + ${x}px - 7px)`;
            el.style.top = `calc(50% + ${y}px - 7px)`;
            container.appendChild(el);
        }
    }

    // ================= ç†±å­¸é‚è¼¯ =================
    let heatTimer = null;
    let tempWater = 20, tempOil = 20;
    const mass = 100, heatPower = 200;

    function startHeating() {
        document.querySelectorAll('.fire').forEach(el => el.classList.add('active'));
        if(heatTimer) return;
        heatTimer = setInterval(() => {
            let dtWater = heatPower / (mass * 1.0);
            let dtOil = heatPower / (mass * 0.5);
            tempWater = Math.min(100, tempWater + dtWater * 0.05);
            tempOil = Math.min(100, tempOil + dtOil * 0.05);
            updateHeatDisplay();
        }, 100);
    }

    function stopHeating() {
        document.querySelectorAll('.fire').forEach(el => el.classList.remove('active'));
        clearInterval(heatTimer);
        heatTimer = null;
    }

    function resetHeat() {
        stopHeating();
        tempWater = 20; tempOil = 20;
        updateHeatDisplay();
    }

    function updateHeatDisplay() {
        document.getElementById('merc-water').style.height = tempWater + '%';
        document.getElementById('merc-oil').style.height = tempOil + '%';
        document.getElementById('temp-water').innerText = Math.floor(tempWater);
        document.getElementById('temp-oil').innerText = Math.floor(tempOil);
    }

    // ================= æ¸¬é©—é‚è¼¯ (New) =================
    const quizData = [
        {
            q: "å†¬å¤©æ‘¸é‡‘å±¬é–€æŠŠè¦ºå¾—æ¯”æ‘¸æœ¨é–€å†°å†·ï¼Œæ˜¯å› ç‚ºé‡‘å±¬å…·æœ‰å“ªç¨®ç‰¹æ€§ï¼Ÿ",
            options: ["é‡‘å±¬æº«åº¦è¼ƒä½", "é‡‘å±¬æ¯”ç†±è¼ƒå¤§", "é‡‘å±¬å°ç†±è¼ƒå¿«", "é‡‘å±¬å®¹æ˜“è¼»å°„"],
            ans: 2,
            reason: "éŒ¯è¦ºï¼æº«åº¦æ˜¯ä¸€æ¨£çš„ã€‚æ˜¯å› ç‚ºé‡‘å±¬æ˜¯è‰¯å°é«”ï¼Œæ‰‹æ‘¸ä¸Šå»ç†±é‡ã€Œå’»ã€ä¸€ä¸‹å°±è¢«å¸èµ°äº†ï¼Œæ‰€ä»¥è¦ºå¾—å†·ã€‚"
        },
        {
            q: "æœ‰é—œåŸå­çµæ§‹ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ",
            options: ["è³ªå­ä½æ–¼åŸå­æ ¸å¤–", "é›»å­è³ªé‡æ¥µè¼•", "ä¸­å­å¸¶è² é›»", "åŸå­æ ¸ä½”æ“šå¤§ç©ºé–“"],
            ans: 1,
            reason: "é›»å­è³ªé‡å¤§ç´„åªæœ‰è³ªå­çš„ 1/1840ï¼Œå¹¾ä¹å¯ä»¥å¿½ç•¥ã€‚åŸå­æ ¸éå¸¸å°ä¸”é‡ï¼Œä½æ–¼ä¸­å¿ƒã€‚"
        },
        {
            q: "å·²çŸ¥éˆ‰ (Na) åŸå­åº 11ï¼Œè³ªé‡æ•¸ 23ã€‚è«‹å•ä¸­å­æ•¸æ˜¯å¤šå°‘ï¼Ÿ",
            options: ["11", "12", "23", "34"],
            ans: 1,
            reason: "å…¬å¼ï¼šè³ªé‡æ•¸ = è³ªå­ + ä¸­å­ã€‚æ‰€ä»¥ 23 = 11 + ä¸­å­ï¼Œä¸­å­ = 12ã€‚"
        },
        {
            q: "ç¢³-12 å’Œ ç¢³-14 æ˜¯ã€ŒåŒä½ç´ ã€ï¼Œå®ƒå€‘æœ‰ä»€éº¼ä¸åŒï¼Ÿ",
            options: ["åŸå­åºä¸åŒ", "è³ªå­æ•¸ä¸åŒ", "é›»å­æ•¸ä¸åŒ", "ä¸­å­æ•¸ä¸åŒ"],
            ans: 3,
            reason: "æ—¢ç„¶éƒ½å«ã€Œç¢³ã€ï¼Œè³ªå­æ•¸(èº«åˆ†è­‰)ä¸€å®šä¸€æ¨£ï¼å·®åˆ¥åªåœ¨èƒ–ç˜¦(ä¸­å­æ•¸ä¸åŒ)ã€‚"
        },
        {
            q: "ç†±æ°´æ”¾ç½®å†·å»æ™‚ï¼Œä¸‹åˆ—å“ªç¨®æ•£ç†±æ–¹å¼ã€Œæœ€ä¸ä¸»è¦ã€ï¼Ÿ",
            options: ["æ°´é¢è’¸ç™¼", "å°æµå¸¶èµ°ç†±é‡", "æ¯å£å‚³å°", "è¼»å°„ç©¿é€é‡‘å±¬æ¯"],
            ans: 3,
            reason: "é‡‘å±¬æœƒé˜»æ“‹ä¸¦åå°„è¼»å°„ï¼Œç†±è¼»å°„å¾ˆé›£ç›´æ¥ã€Œç©¿é€ã€é‡‘å±¬æ¯å£æ•£å¤±ã€‚"
        },
        {
            q: "ç¾ä»£é€±æœŸè¡¨æ˜¯ä¾æ“šä»€éº¼æ’åˆ—çš„ï¼Ÿ",
            options: ["åŸå­é‡", "åŸå­åº", "ç™¼ç¾æ™‚é–“", "é¡è‰²"],
            ans: 1,
            reason: "è«ç‘Ÿé‡Œç™¼ç¾ï¼Œç”¨ã€ŒåŸå­åºã€(è³ªå­æ•¸) æ’åˆ—æ‰æ˜¯æœ€æº–ç¢ºçš„è¦å¾‹ï¼Œè€Œä¸æ˜¯é‡é‡å–”ã€‚"
        },
        {
            q: "é—œæ–¼ 1A æ— (é¹¼é‡‘å±¬)ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ",
            options: ["æ´»æ€§å¾ˆå°", "é‡æ°´æœƒåŠ‡çƒˆåæ‡‰", "å¤§å¤šæ˜¯æ°£é«”", "åœ¨é€±æœŸè¡¨æœ€å³é‚Š"],
            ans: 1,
            reason: "é‹°éˆ‰é‰€æ”¾å…¥æ°´ä¸­æœƒã€Œæ»‹æ»‹æ»‹ã€ç”¢ç”Ÿæ°«æ°£ç”šè‡³èµ·ç«ï¼Œæ´»æ€§éå¸¸å¤§ï¼"
        },
        {
            q: "100g æ°´(S=1) èˆ‡ 100g æ²¹(S=0.5) åŠ ç†±ç›¸åŒæ™‚é–“ï¼Œèª°æº«åº¦å‡å¾—å¿«ï¼Ÿ",
            options: ["æ°´", "æ²¹", "ä¸€æ¨£å¿«", "ç„¡æ³•åˆ¤æ–·"],
            ans: 1,
            reason: "æ¯”ç†±å°çš„äººè„¾æ°£ä¸å¥½(æ˜“ç†±æ˜“å†·)ã€‚æ²¹çš„æ¯”ç†±åªæœ‰ä¸€åŠï¼Œæ‰€ä»¥å‡æº«é€Ÿåº¦æ˜¯æ°´çš„å…©å€ï¼"
        },
        {
            q: "ä¸­æ€§åŸå­å¤±å» 2 å€‹é›»å­å¾Œï¼Œæœƒè®Šæˆï¼Ÿ",
            options: ["å¸¶ -2 é›»é™°é›¢å­", "å¸¶ +2 é›»é™½é›¢å­", "æ–°å…ƒç´ ", "åŒä½ç´ "],
            ans: 1,
            reason: "é›»å­æ˜¯ã€Œè² å‚µã€ã€‚ä¸Ÿæ‰å…©ç­†è² å‚µï¼Œä½ çš„è³‡ç”¢å°±è®Šå¤šäº†(å¸¶æ­£é›»)ï¼"
        },
        {
            q: "ä¸‹åˆ—å¸¸æº«å¸¸å£“ä¸‹çš„ç‹€æ…‹ï¼Œä½•è€…éŒ¯èª¤ï¼Ÿ",
            options: ["æ±æ˜¯æ¶²æ…‹é‡‘å±¬", "æº´æ˜¯æ¶²æ…‹éé‡‘å±¬", "çŸ³å¢¨å°é›»æ€§ä½³", "çŸ³å¢¨æ˜¯é‡‘å±¬"],
            ans: 3,
            reason: "çŸ³å¢¨(ç¢³)é›–ç„¶æœƒå°é›»ï¼Œä½†å®ƒæ˜¯ã€Œéé‡‘å±¬ã€å–”ï¼é€™æ˜¯å”¯ä¸€çš„ç‰¹ä¾‹ã€‚"
        }
    ];

    let currentQ = 0;
    let score = 0;
    let answered = false;

    function startQuiz() {
        document.getElementById('quiz-start-screen').style.display = 'none';
        document.getElementById('quiz-question-screen').style.display = 'block';
        currentQ = 0;
        score = 0;
        loadQuestion();
    }

    function loadQuestion() {
        answered = false;
        let q = quizData[currentQ];
        document.getElementById('q-idx').innerText = currentQ + 1;
        document.getElementById('q-text').innerText = q.q;
        document.getElementById('feedback-box').style.display = 'none';
        document.getElementById('btn-next').style.display = 'none';
        
        const div = document.getElementById('opt-container');
        div.innerHTML = '';
        
        q.options.forEach((opt, idx) => {
            let btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(idx, btn);
            div.appendChild(btn);
        });
    }

    function checkAnswer(idx, btnElem) {
        if(answered) return;
        answered = true;
        
        let q = quizData[currentQ];
        let allBtns = document.querySelectorAll('.opt-btn');
        let feedback = document.getElementById('feedback-box');
        
        if(idx === q.ans) {
            score += 10;
            btnElem.classList.add('correct');
            feedback.className = 'feedback-box correct';
            document.getElementById('fb-title').innerText = "ğŸ‰ ç­”å°äº†ï¼";
            document.getElementById('fb-title').style.color = "#155724";
        } else {
            btnElem.classList.add('wrong');
            allBtns[q.ans].classList.add('correct'); // Show correct answer
            feedback.className = 'feedback-box wrong';
            document.getElementById('fb-title').innerText = "ğŸ’¡ è§€å¿µä¿®æ­£";
            document.getElementById('fb-title').style.color = "#721c24";
        }
        
        document.getElementById('fb-text').innerText = q.reason;
        feedback.style.display = 'block';
        document.getElementById('btn-next').style.display = 'block';
    }

    function nextQuestion() {
        currentQ++;
        if(currentQ < quizData.length) {
            loadQuestion();
        } else {
            showResult();
        }
    }

    function showResult() {
        document.getElementById('quiz-question-screen').style.display = 'none';
        document.getElementById('quiz-result-screen').style.display = 'block';
        document.getElementById('final-score').innerText = score;
        
        let msg = "";
        if(score === 100) msg = "å¤ªå¼·äº†ï¼æ²›å¦¤ä½ æ˜¯ç†åŒ–å°å¤©æ‰ï¼ğŸŒŸ";
        else if(score >= 80) msg = "å¾ˆæ£’å–”ï¼è§€å¿µå¾ˆæ¸…æ¥šï¼Œæ³¨æ„å°é™·é˜±å°±å¥½ï¼ğŸ‘";
        else if(score >= 60) msg = "åŠæ ¼é‚Šç·£ï¼ŒæŠŠå‰›å‰›éŒ¯çš„é¡Œç›®å†æƒ³ä¸€æ¬¡å°±é€šäº†ï¼ğŸ’ª";
        else msg = "åˆ¥æ°£é¤’ï¼Œæˆ‘å€‘å†å›å»ç©ä¸€ä¸‹å¯¦é©—å®¤ï¼ŒæŠŠè§€å¿µå¼„æ‡‚ï¼ğŸ”¥";
        document.getElementById('score-msg').innerText = msg;
    }

    // åˆå§‹åŒ–
    updateAtom('p', 0);
    updateHeatDisplay();

</script>
</body>
</html>